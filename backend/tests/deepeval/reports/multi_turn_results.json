{
  "summary": {
    "total_conversations": 42,
    "passed": 16,
    "failed": 26,
    "pass_rate": 38.095238095238095,
    "workflows_completed": 25,
    "workflow_completion_rate": 59.523809523809526,
    "tickets_created": 25,
    "ticket_creation_rate": 59.523809523809526,
    "average_turns": 5.095238095238095,
    "average_duration_ms": 37081.9845,
    "average_metrics": {
      "workflow_completion": 0.44310942730651126,
      "conversation_coherence": 0.6280913917399371,
      "state_transition": 0.6249954181077066,
      "information_extraction": 0.5039766750439915,
      "correction_handling": 0.6057181079421006,
      "first_aid_guidance": 0.5469897084388858
    },
    "category_pass_rates": {
      "fire_emergency_flow": 50.0,
      "medical_emergency_flow": 50.0,
      "security_emergency_flow": 37.5,
      "user_correction_flow": 50.0,
      "authenticated_user_flow": 0.0,
      "edge_case_flow": 20.0
    },
    "evaluation_time": "2026-01-04T03:29:47.491560"
  },
  "results": [
    {
      "test_case_id": "MULTI_FIRE_001",
      "name": "Complete Fire Emergency Flow",
      "category": "fire_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "Ch√°y nh√†! Nh√† t√¥i ƒëang ch√°y l·ªõn l·∫Øm!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. N·∫øu c√≥ b√¨nh ch·ªØa ch√°y, l·∫Øc x√≥c b√¨nh tr∆∞·ªõc khi s·ª≠ d·ª•ng.\n2. Di chuy·ªÉn b√¨nh ƒë·∫øn ƒë√°m ch√°y.\n3. R√∫t ch·ªët an to√†n c·ªßa b√¨nh.\n4. B√≥p van ƒë·ªÉ phun ch·∫•t ch·ªØa ch√°y v√†o ngu·ªìn l·ª≠a.\n5. N·∫øu s·ª≠ d·ª•ng b√¨nh kh√≠, ƒë·ªÅ ph√≤ng nguy c∆° b·ªèng l·∫°nh, g√¢y ho·∫°i t·ª≠ cho da.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "provide_first_aid"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "FIRE_RESCUE"
            ]
          },
          "validation_passed": [
            "Should detect FIRE_RESCUE emergency",
            "Should provide fire safety guidance",
            "Should ask for location"
          ],
          "validation_failed": [],
          "duration_ms": 6824.218034744263,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "41 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 8, Qu·∫≠n 2, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "address": "41 Hai B√† Tr∆∞ng",
              "ward": "Ph∆∞·ªùng 8"
            }
          },
          "validation_passed": [
            "Should extract complete address",
            "Should ask for phone number"
          ],
          "validation_failed": [],
          "duration_ms": 1814.8398399353027,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0523005150",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "people",
          "extractions": {
            "phone": "0523005150"
          },
          "validation_passed": [
            "Should validate phone number",
            "Should ask for number of affected people"
          ],
          "validation_failed": [],
          "duration_ms": 1000.4448890686035,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "3 ng∆∞·ªùi trong nh√†",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 41 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 8, Qu·∫≠n 2, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0523005150\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 3
            }
          },
          "validation_passed": [
            "Should extract 3 people",
            "Should show confirmation summary"
          ],
          "validation_failed": [],
          "duration_ms": 1117.7418231964111,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "ƒê√∫ng r·ªìi, x√°c nh·∫≠n",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-200409-NCFF ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 41 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 8, Qu·∫≠n 2, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0523005150\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 3\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket",
            "provide_final_guidance"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create emergency ticket",
            "Should show ticket ID",
            "Should confirm dispatch"
          ],
          "validation_failed": [],
          "duration_ms": 11350.828886032104,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-200409-NCFF",
      "metrics": {
        "workflow_completion": 0.8422307673261283,
        "conversation_coherence": 0.9835483537103435,
        "state_transition": 0.9982013788228443,
        "information_extraction": 0.8058257276555778,
        "correction_handling": 0.9677933897581579,
        "first_aid_guidance": 0.805194269089484
      },
      "overall_passed": true,
      "total_duration_ms": 68948.429,
      "timestamp": "2026-01-04T03:03:50.032929",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "Ch√°y nh√†! Nh√† t√¥i ƒëang ch√°y l·ªõn l·∫Øm!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. N·∫øu c√≥ b√¨nh ch·ªØa ch√°y, l·∫Øc x√≥c b√¨nh tr∆∞·ªõc khi s·ª≠ d·ª•ng.\n2. Di chuy·ªÉn b√¨nh ƒë·∫øn ƒë√°m ch√°y.\n3. R√∫t ch·ªët an to√†n c·ªßa b√¨nh.\n4. B√≥p van ƒë·ªÉ phun ch·∫•t ch·ªØa ch√°y v√†o ngu·ªìn l·ª≠a.\n5. N·∫øu s·ª≠ d·ª•ng b√¨nh kh√≠, ƒë·ªÅ ph√≤ng nguy c∆° b·ªèng l·∫°nh, g√¢y ho·∫°i t·ª≠ cho da.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "41 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 8, Qu·∫≠n 2, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0523005150"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?"
        },
        {
          "role": "user",
          "message": "3 ng∆∞·ªùi trong nh√†"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 41 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 8, Qu·∫≠n 2, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0523005150\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng r·ªìi, x√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-200409-NCFF ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 41 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 8, Qu·∫≠n 2, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0523005150\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 3\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_FIRE_002",
      "name": "Fire with Trapped People",
      "category": "fire_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "Ch√°y l·ªõn! C√≥ ng∆∞·ªùi m·∫Øc k·∫πt trong nh√† kh√¥ng ra ƒë∆∞·ª£c!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. N·∫øu kh√¥ng th·ªÉ tho√°t ra ngo√†i, h√£y d√πng khƒÉn ho·∫∑c v·∫£i th·∫•m n∆∞·ªõc ƒë·ªÉ ch√®n b·ªãt khe c·ª≠a.\n2. Di chuy·ªÉn ra ban c√¥ng ho·∫∑c c·ª≠a s·ªï, g·ªçi to v√† d√πng ƒë·ªì v·∫≠t s√°ng m√†u ra hi·ªáu c·∫ßu c·ª©u.\n3. N·∫øu t·∫ßng b·ªã ch√°y n·∫±m b√™n d∆∞·ªõi t·∫ßng b·∫°n ƒëang ·ªü, h√£y di chuy·ªÉn l√™n tr√™n c√°ch t·∫ßng b·ªã ch√°y 4-5 t·∫ßng.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "detect_multiple_types",
            "provide_first_aid"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "FIRE_RESCUE",
              "MEDICAL"
            ]
          },
          "validation_passed": [
            "Should detect FIRE_RESCUE and MEDICAL",
            "Should provide urgent guidance",
            "Should ask for location immediately"
          ],
          "validation_failed": [],
          "duration_ms": 6390.644788742065,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "430 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 12, Qu·∫≠n 11",
          "bot_response": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "location",
          "extractions": {
            "location": {
              "address": "430 Nguy·ªÖn Hu·ªá"
            }
          },
          "validation_passed": [
            "Should extract location",
            "Should ask for phone"
          ],
          "validation_failed": [],
          "duration_ms": 1430.5202960968018,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "S·ªë t√¥i l√† 0897155669",
          "bot_response": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "location",
          "extractions": {
            "phone": "0897155669"
          },
          "validation_passed": [
            "Should validate phone",
            "Should ask about trapped people"
          ],
          "validation_failed": [],
          "duration_ms": 1061.6512298583984,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "5 ng∆∞·ªùi, 2 ng∆∞·ªùi m·∫Øc k·∫πt t·∫ßng 3",
          "bot_response": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "location",
          "extractions": {
            "affectedPeople": {
              "total": 5
            }
          },
          "validation_passed": [
            "Should extract 5 people"
          ],
          "validation_failed": [
            "Should show confirmation"
          ],
          "duration_ms": 1213.150978088379,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "location",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create urgent ticket",
            "Should dispatch fire and rescue"
          ],
          "validation_failed": [],
          "duration_ms": 989.1843795776367,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": false,
      "ticket_created": false,
      "ticket_id": null,
      "metrics": {
        "workflow_completion": 0.16886486928112127,
        "conversation_coherence": 0.15809380966157588,
        "state_transition": 0.15115967798988533,
        "information_extraction": 0.21163120524665527,
        "correction_handling": 0.17363040962828488,
        "first_aid_guidance": 0.23979467783226865
      },
      "overall_passed": false,
      "total_duration_ms": 38356.909,
      "timestamp": "2026-01-04T03:04:58.982357",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "Ch√°y l·ªõn! C√≥ ng∆∞·ªùi m·∫Øc k·∫πt trong nh√† kh√¥ng ra ƒë∆∞·ª£c!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. N·∫øu kh√¥ng th·ªÉ tho√°t ra ngo√†i, h√£y d√πng khƒÉn ho·∫∑c v·∫£i th·∫•m n∆∞·ªõc ƒë·ªÉ ch√®n b·ªãt khe c·ª≠a.\n2. Di chuy·ªÉn ra ban c√¥ng ho·∫∑c c·ª≠a s·ªï, g·ªçi to v√† d√πng ƒë·ªì v·∫≠t s√°ng m√†u ra hi·ªáu c·∫ßu c·ª©u.\n3. N·∫øu t·∫ßng b·ªã ch√°y n·∫±m b√™n d∆∞·ªõi t·∫ßng b·∫°n ƒëang ·ªü, h√£y di chuy·ªÉn l√™n tr√™n c√°ch t·∫ßng b·ªã ch√°y 4-5 t·∫ßng.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "430 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 12, Qu·∫≠n 11"
        },
        {
          "role": "bot",
          "message": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "S·ªë t√¥i l√† 0897155669"
        },
        {
          "role": "bot",
          "message": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "5 ng∆∞·ªùi, 2 ng∆∞·ªùi m·∫Øc k·∫πt t·∫ßng 3"
        },
        {
          "role": "bot",
          "message": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        }
      ]
    },
    {
      "test_case_id": "MULTI_FIRE_003",
      "name": "Fire with Partial Location",
      "category": "fire_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ ch√°y ·ªü ƒë√¢y!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. L·∫Øc x√≥c b√¨nh ch·ªØa ch√°y tr∆∞·ªõc khi s·ª≠ d·ª•ng.\n2. Di chuy·ªÉn b√¨nh ƒë·∫øn g·∫ßn ƒë√°m ch√°y.\n3. R√∫t ch·ªët an to√†n c·ªßa b√¨nh ch·ªØa ch√°y.\n4. B√≥p van ƒë·ªÉ phun ch·∫•t ch·ªØa ch√°y v√†o ngu·ªìn l·ª≠a.\n5. Ki·ªÉm tra l·∫°i khu v·ª±c sau khi ch√°y ƒë√£ ƒë∆∞·ª£c d·∫≠p t·∫Øt ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "ask_details"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "FIRE_RESCUE"
            ]
          },
          "validation_passed": [
            "Should detect fire",
            "Should ask for location"
          ],
          "validation_failed": [],
          "duration_ms": 5656.612157821655,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "G·∫ßn ch·ª£ B·∫øn Th√†nh",
          "bot_response": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "extract_partial_location",
            "ask_clarification"
          ],
          "expected_next_step": "location_clarification",
          "actual_next_step": "location",
          "extractions": {
            "location": {
              "landmarks": "G·∫ßn ch·ª£ B·∫øn Th√†nh"
            }
          },
          "validation_passed": [
            "Should extract landmark",
            "Should ask for specific address"
          ],
          "validation_failed": [],
          "duration_ms": 1058.9449405670166,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "197 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 10, Qu·∫≠n T√¢n B√¨nh, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "address": "197 Nguy·ªÖn Tr√£i"
            }
          },
          "validation_passed": [
            "Should extract full address",
            "Should ask for phone"
          ],
          "validation_failed": [],
          "duration_ms": 6750.853538513184,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "0786227881",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "people",
          "extractions": {
            "phone": "0786227881"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 918.7281131744385,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "1 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 197 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 10, Qu·∫≠n T√¢n B√¨nh, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0786227881\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 1
            }
          },
          "validation_passed": [
            "Should extract count"
          ],
          "validation_failed": [],
          "duration_ms": 1418.0445671081543,
          "errors": []
        },
        {
          "turn_number": 6,
          "user_message": "OK",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-200559-3OFG ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 197 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 10, Qu·∫≠n T√¢n B√¨nh, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0786227881\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket"
          ],
          "validation_failed": [],
          "duration_ms": 7009.786128997803,
          "errors": []
        }
      ],
      "total_turns": 6,
      "completed_turns": 6,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-200559-3OFG",
      "metrics": {
        "workflow_completion": 0.6198755098475288,
        "conversation_coherence": 0.8817574469526278,
        "state_transition": 0.9817574485083463,
        "information_extraction": 0.7113735740210397,
        "correction_handling": 0.9318106208860852,
        "first_aid_guidance": 0.70045171971524
      },
      "overall_passed": true,
      "total_duration_ms": 48066.294,
      "timestamp": "2026-01-04T03:05:37.339541",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ ch√°y ·ªü ƒë√¢y!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. L·∫Øc x√≥c b√¨nh ch·ªØa ch√°y tr∆∞·ªõc khi s·ª≠ d·ª•ng.\n2. Di chuy·ªÉn b√¨nh ƒë·∫øn g·∫ßn ƒë√°m ch√°y.\n3. R√∫t ch·ªët an to√†n c·ªßa b√¨nh ch·ªØa ch√°y.\n4. B√≥p van ƒë·ªÉ phun ch·∫•t ch·ªØa ch√°y v√†o ngu·ªìn l·ª≠a.\n5. Ki·ªÉm tra l·∫°i khu v·ª±c sau khi ch√°y ƒë√£ ƒë∆∞·ª£c d·∫≠p t·∫Øt ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "G·∫ßn ch·ª£ B·∫øn Th√†nh"
        },
        {
          "role": "bot",
          "message": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "197 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 10, Qu·∫≠n T√¢n B√¨nh, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0786227881"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?"
        },
        {
          "role": "user",
          "message": "1 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 197 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 10, Qu·∫≠n T√¢n B√¨nh, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0786227881\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "OK"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-200559-3OFG ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 197 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 10, Qu·∫≠n T√¢n B√¨nh, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0786227881\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_FIRE_004",
      "name": "Fire Emergency Variation 1",
      "category": "fire_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "Ch√°y nh√† b·∫øp, l·ª≠a lan nhanh!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† ng∆∞·ªùi xung quanh b·∫±ng c√°ch di chuy·ªÉn m·ªçi ng∆∞·ªùi ra kh·ªèi khu v·ª±c ch√°y.\n2. N·∫øu c√≥ th·ªÉ, h√£y c·∫Øt ngu·ªìn cung c·∫•p gas ho·∫∑c ƒëi·ªán ƒë·ªÉ ngƒÉn ch·∫∑n nguy c∆° ch√°y lan.\n3. S·ª≠ d·ª•ng b√¨nh ch·ªØa ch√°y n·∫øu c√≥ s·∫µn v√† bi·∫øt c√°ch s·ª≠ d·ª•ng:\n   - L·∫Øc x√≥c b√¨nh b·ªôt tr∆∞·ªõc khi s·ª≠ d·ª•ng.\n   - R√∫t ch·ªët an to√†n.\n   - H∆∞·ªõng v√≤i b√¨nh v·ªÅ ph√≠a ƒë√°m ch√°y v√† b√≥p van ƒë·ªÉ phun ch·∫•t ch·ªØa ch√°y.\n4. N·∫øu l·ª≠a qu√° l·ªõn v√† kh√¥ng th·ªÉ ki·ªÉm so√°t, h√£y r·ªùi kh·ªèi hi·ªán tr∆∞·ªùng ngay l·∫≠p t·ª©c v√† t√¨m n∆°i an to√†n.\n5. ƒê√≥ng c·ª≠a ph√≤ng ƒë·ªÉ h·∫°n ch·∫ø l·ª≠a lan ra c√°c khu v·ª±c kh√°c nh∆∞ng kh√¥ng kh√≥a c·ª≠a, ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªèa c√≥ th·ªÉ ti·∫øp c·∫≠n d·ªÖ d√†ng khi h·ªç ƒë·∫øn.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "FIRE_RESCUE"
            ]
          },
          "validation_passed": [
            "Should detect FIRE_RESCUE"
          ],
          "validation_failed": [],
          "duration_ms": 9211.577415466309,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "16 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 14, Qu·∫≠n 7, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "16 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 14, Qu·∫≠n 7, TP.HCM",
              "address": "16 Hai B√† Tr∆∞ng",
              "ward": "Ph∆∞·ªùng 14",
              "district": "Qu·∫≠n 7",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1648.864984512329,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0521549295",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?",
          "expected_actions": [
            "validate_phone"
          ],
          "expected_next_step": "people",
          "actual_next_step": "people",
          "extractions": {
            "phone": "0521549295"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 1112.438678741455,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "1 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 16 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 14, Qu·∫≠n 7, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0521549295\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 1
            }
          },
          "validation_passed": [
            "Should extract count"
          ],
          "validation_failed": [],
          "duration_ms": 882.8754425048828,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "ƒê√∫ng",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-200644-LST4 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 16 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 14, Qu·∫≠n 7, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0521549295\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket"
          ],
          "validation_failed": [],
          "duration_ms": 9929.979801177979,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-200644-LST4",
      "metrics": {
        "workflow_completion": 0.7688057365772438,
        "conversation_coherence": 0.9407333400045932,
        "state_transition": 0.997966764528457,
        "information_extraction": 0.6506158168617097,
        "correction_handling": 0.9239391184283324,
        "first_aid_guidance": 0.8957979677548538
      },
      "overall_passed": true,
      "total_duration_ms": 47451.159,
      "timestamp": "2026-01-04T03:06:25.405939",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "Ch√°y nh√† b·∫øp, l·ª≠a lan nhanh!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† ng∆∞·ªùi xung quanh b·∫±ng c√°ch di chuy·ªÉn m·ªçi ng∆∞·ªùi ra kh·ªèi khu v·ª±c ch√°y.\n2. N·∫øu c√≥ th·ªÉ, h√£y c·∫Øt ngu·ªìn cung c·∫•p gas ho·∫∑c ƒëi·ªán ƒë·ªÉ ngƒÉn ch·∫∑n nguy c∆° ch√°y lan.\n3. S·ª≠ d·ª•ng b√¨nh ch·ªØa ch√°y n·∫øu c√≥ s·∫µn v√† bi·∫øt c√°ch s·ª≠ d·ª•ng:\n   - L·∫Øc x√≥c b√¨nh b·ªôt tr∆∞·ªõc khi s·ª≠ d·ª•ng.\n   - R√∫t ch·ªët an to√†n.\n   - H∆∞·ªõng v√≤i b√¨nh v·ªÅ ph√≠a ƒë√°m ch√°y v√† b√≥p van ƒë·ªÉ phun ch·∫•t ch·ªØa ch√°y.\n4. N·∫øu l·ª≠a qu√° l·ªõn v√† kh√¥ng th·ªÉ ki·ªÉm so√°t, h√£y r·ªùi kh·ªèi hi·ªán tr∆∞·ªùng ngay l·∫≠p t·ª©c v√† t√¨m n∆°i an to√†n.\n5. ƒê√≥ng c·ª≠a ph√≤ng ƒë·ªÉ h·∫°n ch·∫ø l·ª≠a lan ra c√°c khu v·ª±c kh√°c nh∆∞ng kh√¥ng kh√≥a c·ª≠a, ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªèa c√≥ th·ªÉ ti·∫øp c·∫≠n d·ªÖ d√†ng khi h·ªç ƒë·∫øn.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "16 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 14, Qu·∫≠n 7, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0521549295"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?"
        },
        {
          "role": "user",
          "message": "1 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 16 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 14, Qu·∫≠n 7, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0521549295\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-200644-LST4 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 16 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 14, Qu·∫≠n 7, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0521549295\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_FIRE_005",
      "name": "Fire Emergency Variation 2",
      "category": "fire_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "Ch·∫≠p ƒëi·ªán g√¢y ch√°y ph√≤ng ng·ªß!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† ng∆∞·ªùi xung quanh b·∫±ng c√°ch r·ªùi kh·ªèi khu v·ª±c nguy hi·ªÉm n·∫øu c√≥ th·ªÉ.\n2. N·∫øu c√≥ b√¨nh ch·ªØa ch√°y g·∫ßn ƒë√≥, h√£y s·ª≠ d·ª•ng n√≥ ƒë·ªÉ d·∫≠p l·ª≠a. L·∫Øc x√≥c b√¨nh tr∆∞·ªõc khi s·ª≠ d·ª•ng.\n3. R√∫t ch·ªët an to√†n c·ªßa b√¨nh ch·ªØa ch√°y.\n4. H∆∞·ªõng v√≤i b√¨nh ch·ªØa ch√°y v·ªÅ ph√≠a ƒë√°m ch√°y v√† b√≥p van ƒë·ªÉ phun ch·∫•t ch·ªØa ch√°y.\n5. N·∫øu kh√¥ng th·ªÉ ki·ªÉm so√°t ƒë∆∞·ª£c ƒë√°m ch√°y, h√£y r·ªùi kh·ªèi hi·ªán tr∆∞·ªùng v√† t√¨m n∆°i an to√†n.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "FIRE_RESCUE"
            ]
          },
          "validation_passed": [
            "Should detect FIRE_RESCUE"
          ],
          "validation_failed": [],
          "duration_ms": 7525.321245193481,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "240 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 12, Qu·∫≠n 2, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "240 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 12, Qu·∫≠n 2, TP.HCM",
              "address": "240 L√Ω T·ª± Tr·ªçng",
              "ward": "Ph∆∞·ªùng 12",
              "district": "Qu·∫≠n 2",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1469.6483612060547,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0561984872",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?",
          "expected_actions": [
            "validate_phone"
          ],
          "expected_next_step": "people",
          "actual_next_step": "people",
          "extractions": {
            "phone": "0561984872"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 828.777551651001,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "4 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 240 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 12, Qu·∫≠n 2, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0561984872\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 4 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 4
            }
          },
          "validation_passed": [
            "Should extract count"
          ],
          "validation_failed": [],
          "duration_ms": 957.9994678497314,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "ƒê√∫ng",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-200728-W8Y0 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 240 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 12, Qu·∫≠n 2, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0561984872\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 4\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket"
          ],
          "validation_failed": [],
          "duration_ms": 7188.263416290283,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-200728-W8Y0",
      "metrics": {
        "workflow_completion": 0.7184161658480778,
        "conversation_coherence": 0.9531209373373757,
        "state_transition": 0.9979667648438234,
        "information_extraction": 0.7288234967862937,
        "correction_handling": 0.905107250185137,
        "first_aid_guidance": 0.8443548738348641
      },
      "overall_passed": true,
      "total_duration_ms": 40391.426,
      "timestamp": "2026-01-04T03:07:12.857252",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "Ch·∫≠p ƒëi·ªán g√¢y ch√°y ph√≤ng ng·ªß!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† ng∆∞·ªùi xung quanh b·∫±ng c√°ch r·ªùi kh·ªèi khu v·ª±c nguy hi·ªÉm n·∫øu c√≥ th·ªÉ.\n2. N·∫øu c√≥ b√¨nh ch·ªØa ch√°y g·∫ßn ƒë√≥, h√£y s·ª≠ d·ª•ng n√≥ ƒë·ªÉ d·∫≠p l·ª≠a. L·∫Øc x√≥c b√¨nh tr∆∞·ªõc khi s·ª≠ d·ª•ng.\n3. R√∫t ch·ªët an to√†n c·ªßa b√¨nh ch·ªØa ch√°y.\n4. H∆∞·ªõng v√≤i b√¨nh ch·ªØa ch√°y v·ªÅ ph√≠a ƒë√°m ch√°y v√† b√≥p van ƒë·ªÉ phun ch·∫•t ch·ªØa ch√°y.\n5. N·∫øu kh√¥ng th·ªÉ ki·ªÉm so√°t ƒë∆∞·ª£c ƒë√°m ch√°y, h√£y r·ªùi kh·ªèi hi·ªán tr∆∞·ªùng v√† t√¨m n∆°i an to√†n.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "240 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 12, Qu·∫≠n 2, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0561984872"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?"
        },
        {
          "role": "user",
          "message": "4 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 240 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 12, Qu·∫≠n 2, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0561984872\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 4 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-200728-W8Y0 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 240 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 12, Qu·∫≠n 2, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0561984872\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 4\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_FIRE_006",
      "name": "Fire Emergency Variation 3",
      "category": "fire_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "B√¨nh gas ph√°t n·ªï, ch√°y l·ªõn!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. B√°o ƒë·ªông: H√¥ ho√°n, ƒë√°nh k·∫ªng, ·∫•n chu√¥ng b√°o ch√°y ƒë·ªÉ th√¥ng b√°o cho m·ªçi ng∆∞·ªùi xung quanh.\n2. Ng·∫Øt ƒëi·ªán ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n v√† ngƒÉn ch·∫∑n nguy c∆° ch√°y lan do h·ªá th·ªëng ƒëi·ªán.\n3. S·ª≠ d·ª•ng ph∆∞∆°ng ti·ªán ch·ªØa ch√°y ban ƒë·∫ßu nh∆∞ x√¥ ch·∫≠u, chƒÉn chi√™n, b√¨nh ch·ªØa ch√°y, h·ªçng n∆∞·ªõc ch·ªØa ch√°y v√°ch t∆∞·ªùng n·∫øu c√≥ th·ªÉ v√† an to√†n ƒë·ªÉ l√†m.\n4.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "FIRE_RESCUE"
            ]
          },
          "validation_passed": [
            "Should detect FIRE_RESCUE"
          ],
          "validation_failed": [],
          "duration_ms": 7281.584739685059,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "448 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 4, Qu·∫≠n 4, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "448 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 4, Qu·∫≠n 4, TP.HCM",
              "address": "448 Hai B√† Tr∆∞ng",
              "ward": "Ph∆∞·ªùng 4",
              "district": "Qu·∫≠n 4",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1456.7699432373047,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0343831125",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?",
          "expected_actions": [
            "validate_phone"
          ],
          "expected_next_step": "people",
          "actual_next_step": "people",
          "extractions": {
            "phone": "0343831125"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 1385.077714920044,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "2 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 448 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 4, Qu·∫≠n 4, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0343831125\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 2 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 2
            }
          },
          "validation_passed": [
            "Should extract count"
          ],
          "validation_failed": [],
          "duration_ms": 939.24880027771,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "ƒê√∫ng",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-200808-G3R4 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 448 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 4, Qu·∫≠n 4, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0343831125\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 2\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket"
          ],
          "validation_failed": [],
          "duration_ms": 7921.402454376221,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-200808-G3R4",
      "metrics": {
        "workflow_completion": 0.5465282587832808,
        "conversation_coherence": 0.9754914992381604,
        "state_transition": 0.996691402304142,
        "information_extraction": 0.6331426957407716,
        "correction_handling": 0.9302834723926796,
        "first_aid_guidance": 0.6520317548236033
      },
      "overall_passed": false,
      "total_duration_ms": 42935.051999999996,
      "timestamp": "2026-01-04T03:07:53.248962",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "B√¨nh gas ph√°t n·ªï, ch√°y l·ªõn!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. B√°o ƒë·ªông: H√¥ ho√°n, ƒë√°nh k·∫ªng, ·∫•n chu√¥ng b√°o ch√°y ƒë·ªÉ th√¥ng b√°o cho m·ªçi ng∆∞·ªùi xung quanh.\n2. Ng·∫Øt ƒëi·ªán ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n v√† ngƒÉn ch·∫∑n nguy c∆° ch√°y lan do h·ªá th·ªëng ƒëi·ªán.\n3. S·ª≠ d·ª•ng ph∆∞∆°ng ti·ªán ch·ªØa ch√°y ban ƒë·∫ßu nh∆∞ x√¥ ch·∫≠u, chƒÉn chi√™n, b√¨nh ch·ªØa ch√°y, h·ªçng n∆∞·ªõc ch·ªØa ch√°y v√°ch t∆∞·ªùng n·∫øu c√≥ th·ªÉ v√† an to√†n ƒë·ªÉ l√†m.\n4.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "448 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 4, Qu·∫≠n 4, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0343831125"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?"
        },
        {
          "role": "user",
          "message": "2 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 448 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 4, Qu·∫≠n 4, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0343831125\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 2 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-200808-G3R4 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 448 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 4, Qu·∫≠n 4, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0343831125\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 2\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_FIRE_007",
      "name": "Fire Emergency Variation 4",
      "category": "fire_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "Ch√°y kho h√†ng, kh√≥i ƒëen nhi·ªÅu!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† ng∆∞·ªùi xung quanh b·∫±ng c√°ch di chuy·ªÉn ra kh·ªèi khu v·ª±c ch√°y n·∫øu c√≥ th·ªÉ.\n2. N·∫øu c√≥ b√¨nh ch·ªØa ch√°y g·∫ßn ƒë√≥ v√† b·∫°n ƒë√£ ƒë∆∞·ª£c ƒë√†o t·∫°o c√°ch s·ª≠ d·ª•ng, h√£y th·ª±c hi·ªán theo c√°c b∆∞·ªõc:\n   - L·∫Øc x√≥c b√¨nh b·ªôt tr∆∞·ªõc khi s·ª≠ d·ª•ng.\n   - Di chuy·ªÉn b√¨nh ƒë·∫øn g·∫ßn ƒë√°m ch√°y.\n   - R√∫t ch·ªët an to√†n.\n   - B√≥p van ƒë·ªÉ phun ch·∫•t ch·ªØa ch√°y v√†o ngu·ªìn g·ªëc c·ªßa ƒë√°m ch√°y.\n3. N·∫øu ch√°y lan r·ªông v√† kh√¥ng th·ªÉ ki·ªÉm so√°t, h√£y t√¨m c√°ch tho√°t ra ngo√†i ngay l·∫≠p t·ª©c v√† t√¨m n∆°i an to√†n.\n4. Tr√°nh h√≠t ph·∫£i kh√≥i b·∫±ng c√°ch che m·∫∑t b·∫±ng khƒÉn ·∫©m ho·∫∑c √°o.\n5. B√°o c√°o v·ªõi l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng v·ªÅ t√¨nh h√¨nh ch√°y v√† v·ªã tr√≠ c·ª• th·ªÉ c·ªßa b·∫°n n·∫øu c√≤n trong khu v·ª±c nguy hi·ªÉm.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "FIRE_RESCUE"
            ]
          },
          "validation_passed": [
            "Should detect FIRE_RESCUE"
          ],
          "validation_failed": [],
          "duration_ms": 9395.334005355835,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "90 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 9, Th√†nh ph·ªë Th·ªß ƒê·ª©c, TP.HCM",
          "bot_response": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "extract_location"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "location",
          "extractions": {
            "location": {
              "full": "90 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 9, Th√†nh ph·ªë Th·ªß ƒê·ª©c, TP.HCM",
              "address": "90 C√°ch M·∫°ng Th√°ng 8",
              "ward": "Ph∆∞·ªùng 9",
              "district": "Th√†nh ph·ªë Th·ªß ƒê·ª©c",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1918.6654090881348,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0896891795",
          "bot_response": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "validate_phone"
          ],
          "expected_next_step": "people",
          "actual_next_step": "location",
          "extractions": {
            "phone": "0896891795"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 976.8533706665039,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "3 ng∆∞·ªùi",
          "bot_response": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "extract_people_count"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "location",
          "extractions": {
            "affectedPeople": {
              "total": 3
            }
          },
          "validation_passed": [
            "Should extract count"
          ],
          "validation_failed": [],
          "duration_ms": 1369.396448135376,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "ƒê√∫ng",
          "bot_response": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "location",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [],
          "validation_failed": [
            "Should create ticket"
          ],
          "duration_ms": 1023.1945514678955,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": false,
      "ticket_created": false,
      "ticket_id": null,
      "metrics": {
        "workflow_completion": 0.15462552930568874,
        "conversation_coherence": 0.18638778772309064,
        "state_transition": 0.07772467980429205,
        "information_extraction": 0.19706375454162,
        "correction_handling": 0.16118789533027922,
        "first_aid_guidance": 0.5146757285183629
      },
      "overall_passed": false,
      "total_duration_ms": 38704.559,
      "timestamp": "2026-01-04T03:08:36.184233",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "Ch√°y kho h√†ng, kh√≥i ƒëen nhi·ªÅu!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† ng∆∞·ªùi xung quanh b·∫±ng c√°ch di chuy·ªÉn ra kh·ªèi khu v·ª±c ch√°y n·∫øu c√≥ th·ªÉ.\n2. N·∫øu c√≥ b√¨nh ch·ªØa ch√°y g·∫ßn ƒë√≥ v√† b·∫°n ƒë√£ ƒë∆∞·ª£c ƒë√†o t·∫°o c√°ch s·ª≠ d·ª•ng, h√£y th·ª±c hi·ªán theo c√°c b∆∞·ªõc:\n   - L·∫Øc x√≥c b√¨nh b·ªôt tr∆∞·ªõc khi s·ª≠ d·ª•ng.\n   - Di chuy·ªÉn b√¨nh ƒë·∫øn g·∫ßn ƒë√°m ch√°y.\n   - R√∫t ch·ªët an to√†n.\n   - B√≥p van ƒë·ªÉ phun ch·∫•t ch·ªØa ch√°y v√†o ngu·ªìn g·ªëc c·ªßa ƒë√°m ch√°y.\n3. N·∫øu ch√°y lan r·ªông v√† kh√¥ng th·ªÉ ki·ªÉm so√°t, h√£y t√¨m c√°ch tho√°t ra ngo√†i ngay l·∫≠p t·ª©c v√† t√¨m n∆°i an to√†n.\n4. Tr√°nh h√≠t ph·∫£i kh√≥i b·∫±ng c√°ch che m·∫∑t b·∫±ng khƒÉn ·∫©m ho·∫∑c √°o.\n5. B√°o c√°o v·ªõi l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng v·ªÅ t√¨nh h√¨nh ch√°y v√† v·ªã tr√≠ c·ª• th·ªÉ c·ªßa b·∫°n n·∫øu c√≤n trong khu v·ª±c nguy hi·ªÉm.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "90 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 9, Th√†nh ph·ªë Th·ªß ƒê·ª©c, TP.HCM"
        },
        {
          "role": "bot",
          "message": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "0896891795"
        },
        {
          "role": "bot",
          "message": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "3 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng"
        },
        {
          "role": "bot",
          "message": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        }
      ]
    },
    {
      "test_case_id": "MULTI_FIRE_008",
      "name": "Fire Emergency Variation 5",
      "category": "fire_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "Xe √¥ t√¥ b·ªëc ch√°y trong garage!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† ng∆∞·ªùi xung quanh b·∫±ng c√°ch r·ªùi kh·ªèi khu v·ª±c nguy hi·ªÉm n·∫øu kh√≥i v√† l·ª≠a lan r·ªông.\n2. S·ª≠ d·ª•ng b√¨nh ch·ªØa ch√°y n·∫øu c√≥ th·ªÉ v√† an to√†n ƒë·ªÉ ti·∫øp c·∫≠n:\n   - L·∫Øc x√≥c b√¨nh b·ªôt tr∆∞·ªõc khi s·ª≠ d·ª•ng.\n   - ƒê·ªÅ ph√≤ng nguy c∆° b·ªèng l·∫°nh khi s·ª≠ d·ª•ng b√¨nh kh√≠.\n3. Di chuy·ªÉn b√¨nh ch·ªØa ch√°y ƒë·∫øn g·∫ßn ƒë√°m ch√°y.\n4. R√∫t ch·ªët an to√†n c·ªßa b√¨nh ch·ªØa ch√°y.\n5. B√≥p van v√† h∆∞·ªõng d√≤ng ch·∫•t ch·ªØa ch√°y v√†o g·ªëc l·ª≠a.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "FIRE_RESCUE"
            ]
          },
          "validation_passed": [
            "Should detect FIRE_RESCUE"
          ],
          "validation_failed": [],
          "duration_ms": 7635.224342346191,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "299 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 14, Huy·ªán Nh√† B√®, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "299 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 14, Huy·ªán Nh√† B√®, TP.HCM",
              "address": "299 ƒêi·ªán Bi√™n Ph·ªß",
              "ward": "Ph∆∞·ªùng 14",
              "district": "Huy·ªán Nh√† B√®",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1532.151222229004,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0812747949",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?",
          "expected_actions": [
            "validate_phone"
          ],
          "expected_next_step": "people",
          "actual_next_step": "people",
          "extractions": {
            "phone": "0812747949"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 957.162618637085,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "3 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 299 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 14, Huy·ªán Nh√† B√®, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0812747949\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 3
            }
          },
          "validation_passed": [
            "Should extract count"
          ],
          "validation_failed": [],
          "duration_ms": 1084.5770835876465,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "ƒê√∫ng",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-200930-OSEC ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 299 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 14, Huy·ªán Nh√† B√®, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0812747949\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 3\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket"
          ],
          "validation_failed": [],
          "duration_ms": 7335.578441619873,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-200930-OSEC",
      "metrics": {
        "workflow_completion": 0.6590867412234077,
        "conversation_coherence": 0.9622459331201855,
        "state_transition": 0.996267310957702,
        "information_extraction": 0.6305258875589448,
        "correction_handling": 0.9323703622885245,
        "first_aid_guidance": 0.8197853311358958
      },
      "overall_passed": true,
      "total_duration_ms": 44103.986,
      "timestamp": "2026-01-04T03:09:14.889037",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "Xe √¥ t√¥ b·ªëc ch√°y trong garage!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† ng∆∞·ªùi xung quanh b·∫±ng c√°ch r·ªùi kh·ªèi khu v·ª±c nguy hi·ªÉm n·∫øu kh√≥i v√† l·ª≠a lan r·ªông.\n2. S·ª≠ d·ª•ng b√¨nh ch·ªØa ch√°y n·∫øu c√≥ th·ªÉ v√† an to√†n ƒë·ªÉ ti·∫øp c·∫≠n:\n   - L·∫Øc x√≥c b√¨nh b·ªôt tr∆∞·ªõc khi s·ª≠ d·ª•ng.\n   - ƒê·ªÅ ph√≤ng nguy c∆° b·ªèng l·∫°nh khi s·ª≠ d·ª•ng b√¨nh kh√≠.\n3. Di chuy·ªÉn b√¨nh ch·ªØa ch√°y ƒë·∫øn g·∫ßn ƒë√°m ch√°y.\n4. R√∫t ch·ªët an to√†n c·ªßa b√¨nh ch·ªØa ch√°y.\n5. B√≥p van v√† h∆∞·ªõng d√≤ng ch·∫•t ch·ªØa ch√°y v√†o g·ªëc l·ª≠a.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "299 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 14, Huy·ªán Nh√† B√®, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0812747949"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?"
        },
        {
          "role": "user",
          "message": "3 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 299 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 14, Huy·ªán Nh√† B√®, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0812747949\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-200930-OSEC ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 299 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 14, Huy·ªán Nh√† B√®, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0812747949\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 3\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_FIRE_009",
      "name": "Fire Emergency Variation 6",
      "category": "fire_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "Ch√°y t·∫ßng h·∫ßm chung c∆∞!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† ng∆∞·ªùi xung quanh b·∫±ng c√°ch di chuy·ªÉn ra kh·ªèi khu v·ª±c ch√°y n·∫øu c√≥ th·ªÉ.\n2. S·ª≠ d·ª•ng b√¨nh ch·ªØa ch√°y n·∫øu c√≥ v√† bi·∫øt c√°ch s·ª≠ d·ª•ng: L·∫Øc x√≥c b√¨nh b·ªôt tr∆∞·ªõc khi s·ª≠ d·ª•ng, ƒë·ªÅ ph√≤ng b√¨nh kh√≠ g√¢y b·ªèng l·∫°nh.\n3. Di chuy·ªÉn b√¨nh ch·ªØa ch√°y ƒë·∫øn g·∫ßn ƒë√°m ch√°y.\n4. R√∫t ch·ªët b√¨nh ch·ªØa ch√°y.\n5. B√≥p van v√† h∆∞·ªõng d√≤ng ch·∫•t ch·ªØa ch√°y v√†o g·ªëc l·ª≠a.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "FIRE_RESCUE"
            ]
          },
          "validation_passed": [
            "Should detect FIRE_RESCUE"
          ],
          "validation_failed": [],
          "duration_ms": 6615.3905391693115,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "273 L√™ L·ª£i, Ph∆∞·ªùng 14, Qu·∫≠n B√¨nh Th·∫°nh, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "273 L√™ L·ª£i, Ph∆∞·ªùng 14, Qu·∫≠n B√¨nh Th·∫°nh, TP.HCM",
              "address": "273 L√™ L·ª£i",
              "ward": "Ph∆∞·ªùng 14",
              "district": "Qu·∫≠n B√¨nh Th·∫°nh",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1547.0900535583496,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0883444961",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?",
          "expected_actions": [
            "validate_phone"
          ],
          "expected_next_step": "people",
          "actual_next_step": "people",
          "extractions": {
            "phone": "0883444961"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 868.3145046234131,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "7 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 273 L√™ L·ª£i, Ph∆∞·ªùng 14, Qu·∫≠n B√¨nh Th·∫°nh, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0883444961\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 7 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 7
            }
          },
          "validation_passed": [
            "Should extract count"
          ],
          "validation_failed": [],
          "duration_ms": 883.0876350402832,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "ƒê√∫ng",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201013-I9Z1 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 273 L√™ L·ª£i, Ph∆∞·ªùng 14, Qu·∫≠n B√¨nh Th·∫°nh, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0883444961\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 7\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket"
          ],
          "validation_failed": [],
          "duration_ms": 7794.892311096191,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-201013-I9Z1",
      "metrics": {
        "workflow_completion": 0.6172928619074549,
        "conversation_coherence": 0.9679178712162946,
        "state_transition": 0.9966914022803064,
        "information_extraction": 0.5876345002252135,
        "correction_handling": 0.927051183947856,
        "first_aid_guidance": 0.7949697985969333
      },
      "overall_passed": false,
      "total_duration_ms": 40113.391,
      "timestamp": "2026-01-04T03:09:58.993319",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "Ch√°y t·∫ßng h·∫ßm chung c∆∞!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† ng∆∞·ªùi xung quanh b·∫±ng c√°ch di chuy·ªÉn ra kh·ªèi khu v·ª±c ch√°y n·∫øu c√≥ th·ªÉ.\n2. S·ª≠ d·ª•ng b√¨nh ch·ªØa ch√°y n·∫øu c√≥ v√† bi·∫øt c√°ch s·ª≠ d·ª•ng: L·∫Øc x√≥c b√¨nh b·ªôt tr∆∞·ªõc khi s·ª≠ d·ª•ng, ƒë·ªÅ ph√≤ng b√¨nh kh√≠ g√¢y b·ªèng l·∫°nh.\n3. Di chuy·ªÉn b√¨nh ch·ªØa ch√°y ƒë·∫øn g·∫ßn ƒë√°m ch√°y.\n4. R√∫t ch·ªët b√¨nh ch·ªØa ch√°y.\n5. B√≥p van v√† h∆∞·ªõng d√≤ng ch·∫•t ch·ªØa ch√°y v√†o g·ªëc l·ª≠a.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "273 L√™ L·ª£i, Ph∆∞·ªùng 14, Qu·∫≠n B√¨nh Th·∫°nh, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0883444961"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?"
        },
        {
          "role": "user",
          "message": "7 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 273 L√™ L·ª£i, Ph∆∞·ªùng 14, Qu·∫≠n B√¨nh Th·∫°nh, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0883444961\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 7 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201013-I9Z1 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 273 L√™ L·ª£i, Ph∆∞·ªùng 14, Qu·∫≠n B√¨nh Th·∫°nh, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0883444961\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 7\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_FIRE_010",
      "name": "Fire Emergency Variation 7",
      "category": "fire_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "Ch√°y do ƒë·ªët v√†ng m√£!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† ng∆∞·ªùi xung quanh b·∫±ng c√°ch di chuy·ªÉn ra kh·ªèi khu v·ª±c ch√°y n·∫øu c√≥ th·ªÉ.\n2. S·ª≠ d·ª•ng b√¨nh ch·ªØa ch√°y n·∫øu c√≥ s·∫µn v√† bi·∫øt c√°ch s·ª≠ d·ª•ng:\n   - L·∫Øc x√≥c b√¨nh b·ªôt tr∆∞·ªõc khi s·ª≠ d·ª•ng.\n   - ƒê·ªÅ ph√≤ng nguy c∆° b·ªèng l·∫°nh khi s·ª≠ d·ª•ng b√¨nh kh√≠.\n3. Di chuy·ªÉn b√¨nh ch·ªØa ch√°y ƒë·∫øn g·∫ßn ƒë√°m ch√°y.\n4. R√∫t ch·ªët an to√†n c·ªßa b√¨nh ch·ªØa ch√°y.\n5. B√≥p van v√† h∆∞·ªõng d√≤ng ch·∫•t ch·ªØa ch√°y v√†o g·ªëc c·ªßa ƒë√°m ch√°y.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "FIRE_RESCUE"
            ]
          },
          "validation_passed": [
            "Should detect FIRE_RESCUE"
          ],
          "validation_failed": [],
          "duration_ms": 6981.283903121948,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "121 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 7, Qu·∫≠n T√¢n Ph√∫, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "121 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 7, Qu·∫≠n T√¢n Ph√∫, TP.HCM",
              "address": "121 Hai B√† Tr∆∞ng",
              "ward": "Ph∆∞·ªùng 7",
              "district": "Qu·∫≠n T√¢n Ph√∫",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1547.1899509429932,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0388670884",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?",
          "expected_actions": [
            "validate_phone"
          ],
          "expected_next_step": "people",
          "actual_next_step": "people",
          "extractions": {
            "phone": "0388670884"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 951.4243602752686,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "5 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 121 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 7, Qu·∫≠n T√¢n Ph√∫, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0388670884\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 5 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 5
            }
          },
          "validation_passed": [
            "Should extract count"
          ],
          "validation_failed": [],
          "duration_ms": 914.9744510650635,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "ƒê√∫ng",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201055-70VQ ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 121 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 7, Qu·∫≠n T√¢n Ph√∫, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0388670884\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 5\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket"
          ],
          "validation_failed": [],
          "duration_ms": 8677.960395812988,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-201055-70VQ",
      "metrics": {
        "workflow_completion": 0.522642383086615,
        "conversation_coherence": 0.959266659995407,
        "state_transition": 0.9946596672648317,
        "information_extraction": 0.6249484483803189,
        "correction_handling": 0.9552246182226678,
        "first_aid_guidance": 0.8443548743037443
      },
      "overall_passed": false,
      "total_duration_ms": 43492.032,
      "timestamp": "2026-01-04T03:10:39.106947",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "Ch√°y do ƒë·ªët v√†ng m√£!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† ng∆∞·ªùi xung quanh b·∫±ng c√°ch di chuy·ªÉn ra kh·ªèi khu v·ª±c ch√°y n·∫øu c√≥ th·ªÉ.\n2. S·ª≠ d·ª•ng b√¨nh ch·ªØa ch√°y n·∫øu c√≥ s·∫µn v√† bi·∫øt c√°ch s·ª≠ d·ª•ng:\n   - L·∫Øc x√≥c b√¨nh b·ªôt tr∆∞·ªõc khi s·ª≠ d·ª•ng.\n   - ƒê·ªÅ ph√≤ng nguy c∆° b·ªèng l·∫°nh khi s·ª≠ d·ª•ng b√¨nh kh√≠.\n3. Di chuy·ªÉn b√¨nh ch·ªØa ch√°y ƒë·∫øn g·∫ßn ƒë√°m ch√°y.\n4. R√∫t ch·ªët an to√†n c·ªßa b√¨nh ch·ªØa ch√°y.\n5. B√≥p van v√† h∆∞·ªõng d√≤ng ch·∫•t ch·ªØa ch√°y v√†o g·ªëc c·ªßa ƒë√°m ch√°y.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "121 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 7, Qu·∫≠n T√¢n Ph√∫, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0388670884"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?"
        },
        {
          "role": "user",
          "message": "5 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 121 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 7, Qu·∫≠n T√¢n Ph√∫, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0388670884\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 5 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201055-70VQ ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 121 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 7, Qu·∫≠n T√¢n Ph√∫, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0388670884\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 5\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_MED_001",
      "name": "Medical Emergency: C√≥ ng∆∞·ªùi b·ªã tai n·∫°n giao th√¥ng...",
      "category": "medical_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ ng∆∞·ªùi b·ªã tai n·∫°n giao th√¥ng! Ng∆∞·ªùi ta n·∫±m tr√™n ƒë∆∞·ªùng, ch·∫£y m√°u nhi·ªÅu!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho ch√≠nh b·∫°n v√† hi·ªán tr∆∞·ªùng xung quanh n·∫°n nh√¢n, lo·∫°i b·ªè m·ªçi nguy c∆° ch·∫≠p ƒëi·ªán, ch√°y n·ªï, xe c·ªô qua l·∫°i.\n2. Ki·ªÉm tra ƒë√°p ·ª©ng c·ªßa n·∫°n nh√¢n b·∫±ng c√°ch lay g·ªçi ho·∫∑c k√≠ch th√≠ch ƒëau nh·∫π.\n3. N·∫øu n·∫°n nh√¢n ch·∫£y m√°u nhi·ªÅu, s·ª≠ d·ª•ng bƒÉng ho·∫∑c v·∫£i s·∫°ch √°p l·ª±c tr·ª±c ti·∫øp l√™n v·∫øt th∆∞∆°ng ƒë·ªÉ c·∫ßm m√°u.\n4. Kh√¥ng di chuy·ªÉn n·∫°n nh√¢n n·∫øu nghi ng·ªù ch·∫•n th∆∞∆°ng c·ªôt s·ªëng ho·∫∑c ch·∫•n th∆∞∆°ng nghi√™m tr·ªçng kh√°c.\n5. K√™u g·ªçi s·ª± gi√∫p ƒë·ª° t·ª´ nh·ªØng ng∆∞·ªùi xung quanh v√† chu·∫©n b·ªã cung c·∫•p th√¥ng tin chi ti·∫øt v·ªÅ t√¨nh tr·∫°ng c·ªßa n·∫°n nh√¢n cho nh√¢n vi√™n y t·∫ø khi h·ªç ƒë·∫øn.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "provide_first_aid"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "MEDICAL"
            ]
          },
          "validation_passed": [
            "Should detect ['MEDICAL']",
            "Should mention: ch·∫£y m√°u, c·∫ßm m√°u"
          ],
          "validation_failed": [],
          "duration_ms": 12096.894025802612,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "297 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 7, Qu·∫≠n T√¢n Ph√∫, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "297 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 7, Qu·∫≠n T√¢n Ph√∫, TP.HCM",
              "address": "297 ƒêi·ªán Bi√™n Ph·ªß",
              "ward": "Ph∆∞·ªùng 7",
              "district": "Qu·∫≠n T√¢n Ph√∫",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1499.711275100708,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0789041572",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 297 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 7, Qu·∫≠n T√¢n Ph√∫, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0789041572\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "phone",
          "extractions": {
            "phone": "0789041572"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 900.7868766784668,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "2 ng∆∞·ªùi b·ªã th∆∞∆°ng, 1 ng∆∞·ªùi nguy k·ªãch",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 297 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 7, Qu·∫≠n T√¢n Ph√∫, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0789041572\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 2,
              "injured": 2,
              "critical": 1
            }
          },
          "validation_passed": [
            "Should extract affected people correctly"
          ],
          "validation_failed": [],
          "duration_ms": 3956.569194793701,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201145-7SXB ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 297 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 7, Qu·∫≠n T√¢n Ph√∫, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0789041572\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 3\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket",
            "Should dispatch ambulance"
          ],
          "validation_failed": [],
          "duration_ms": 6125.608682632446,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-201145-7SXB",
      "metrics": {
        "workflow_completion": 0.8223828554522692,
        "conversation_coherence": 0.9679178692681617,
        "state_transition": 0.9467755660408539,
        "information_extraction": 0.8817678710151842,
        "correction_handling": 0.8541137198851697,
        "first_aid_guidance": 0.8447653865450366
      },
      "overall_passed": true,
      "total_duration_ms": 51021.731,
      "timestamp": "2026-01-04T03:11:22.599245",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ ng∆∞·ªùi b·ªã tai n·∫°n giao th√¥ng! Ng∆∞·ªùi ta n·∫±m tr√™n ƒë∆∞·ªùng, ch·∫£y m√°u nhi·ªÅu!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho ch√≠nh b·∫°n v√† hi·ªán tr∆∞·ªùng xung quanh n·∫°n nh√¢n, lo·∫°i b·ªè m·ªçi nguy c∆° ch·∫≠p ƒëi·ªán, ch√°y n·ªï, xe c·ªô qua l·∫°i.\n2. Ki·ªÉm tra ƒë√°p ·ª©ng c·ªßa n·∫°n nh√¢n b·∫±ng c√°ch lay g·ªçi ho·∫∑c k√≠ch th√≠ch ƒëau nh·∫π.\n3. N·∫øu n·∫°n nh√¢n ch·∫£y m√°u nhi·ªÅu, s·ª≠ d·ª•ng bƒÉng ho·∫∑c v·∫£i s·∫°ch √°p l·ª±c tr·ª±c ti·∫øp l√™n v·∫øt th∆∞∆°ng ƒë·ªÉ c·∫ßm m√°u.\n4. Kh√¥ng di chuy·ªÉn n·∫°n nh√¢n n·∫øu nghi ng·ªù ch·∫•n th∆∞∆°ng c·ªôt s·ªëng ho·∫∑c ch·∫•n th∆∞∆°ng nghi√™m tr·ªçng kh√°c.\n5. K√™u g·ªçi s·ª± gi√∫p ƒë·ª° t·ª´ nh·ªØng ng∆∞·ªùi xung quanh v√† chu·∫©n b·ªã cung c·∫•p th√¥ng tin chi ti·∫øt v·ªÅ t√¨nh tr·∫°ng c·ªßa n·∫°n nh√¢n cho nh√¢n vi√™n y t·∫ø khi h·ªç ƒë·∫øn.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "297 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 7, Qu·∫≠n T√¢n Ph√∫, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0789041572"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 297 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 7, Qu·∫≠n T√¢n Ph√∫, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0789041572\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "2 ng∆∞·ªùi b·ªã th∆∞∆°ng, 1 ng∆∞·ªùi nguy k·ªãch"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 297 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 7, Qu·∫≠n T√¢n Ph√∫, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0789041572\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201145-7SXB ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 297 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 7, Qu·∫≠n T√¢n Ph√∫, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0789041572\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 3\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_MED_002",
      "name": "Medical Emergency: B√† ngo·∫°i t√¥i b·ªã ƒë·ªôt qu·ªµ! M·ªôt b...",
      "category": "medical_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "B√† ngo·∫°i t√¥i b·ªã ƒë·ªôt qu·ªµ! M·ªôt b√™n m·∫∑t m√©o, n√≥i kh√¥ng r√µ!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o b√† ngo·∫°i ·ªü trong t∆∞ th·∫ø tho·∫£i m√°i v√† an to√†n, tr√°nh di chuy·ªÉn n·∫øu kh√¥ng c·∫ßn thi·∫øt.\n2. Ki·ªÉm tra kh·∫£ nƒÉng ph·∫£n ·ª©ng c·ªßa b√† ngo·∫°i b·∫±ng c√°ch g·ªçi t√™n v√† h·ªèi nh·ªØng c√¢u ƒë∆°n gi·∫£n.\n3. Quan s√°t v√† ghi nh·∫≠n c√°c tri·ªáu ch·ª©ng nh∆∞ m√©o m·∫∑t, kh√≥ n√≥i, ƒë·ªÉ b√°o c√°o cho nh√¢n vi√™n y t·∫ø khi h·ªç ƒë·∫øn.\n4. N·∫øu b√† ngo·∫°i c√≥ kh√≥ khƒÉn trong vi·ªác th·ªü, h√£y n√¢ng cao ƒë·∫ßu v√† vai c·ªßa b√† ƒë·ªÉ gi√∫p b√† th·ªü d·ªÖ d√†ng h∆°n.\n5. Gi·ªØ b√¨nh tƒ©nh v√† ƒë·ªông vi√™n b√† ngo·∫°i, tr√°nh l√†m b√† ho·∫£ng s·ª£ ho·∫∑c lo l·∫Øng th√™m.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "provide_first_aid"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "MEDICAL"
            ]
          },
          "validation_passed": [
            "Should detect ['MEDICAL']",
            "Should mention: ƒë·ªôt qu·ªµ, n·∫±m nghi√™ng"
          ],
          "validation_failed": [],
          "duration_ms": 8329.709529876709,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "423 Tr·∫ßn H∆∞ng ƒê·∫°o, Ph∆∞·ªùng 14, Qu·∫≠n 5, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "423 Tr·∫ßn H∆∞ng ƒê·∫°o, Ph∆∞·ªùng 14, Qu·∫≠n 5, TP.HCM",
              "address": "423 Tr·∫ßn H∆∞ng ƒê·∫°o",
              "ward": "Ph∆∞·ªùng 14",
              "district": "Qu·∫≠n 5",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1633.2449913024902,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0943201269",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 423 Tr·∫ßn H∆∞ng ƒê·∫°o, Ph∆∞·ªùng 14, Qu·∫≠n 5, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0943201269\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "phone",
          "extractions": {
            "phone": "0943201269"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 891.2053108215332,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "1 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 423 Tr·∫ßn H∆∞ng ƒê·∫°o, Ph∆∞·ªùng 14, Qu·∫≠n 5, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0943201269\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 1,
              "critical": 1
            }
          },
          "validation_passed": [
            "Should extract affected people correctly"
          ],
          "validation_failed": [],
          "duration_ms": 3100.2819538116455,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201233-16FY ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 423 Tr·∫ßn H∆∞ng ƒê·∫°o, Ph∆∞·ªùng 14, Qu·∫≠n 5, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0943201269\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket",
            "Should dispatch ambulance"
          ],
          "validation_failed": [],
          "duration_ms": 8457.245111465454,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-201233-16FY",
      "metrics": {
        "workflow_completion": 0.6950402267754259,
        "conversation_coherence": 0.8629328891361098,
        "state_transition": 0.9127913296015165,
        "information_extraction": 0.8500761480432256,
        "correction_handling": 0.9595985163520927,
        "first_aid_guidance": 0.8002095063348911
      },
      "overall_passed": true,
      "total_duration_ms": 44415.793,
      "timestamp": "2026-01-04T03:12:13.621076",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "B√† ngo·∫°i t√¥i b·ªã ƒë·ªôt qu·ªµ! M·ªôt b√™n m·∫∑t m√©o, n√≥i kh√¥ng r√µ!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o b√† ngo·∫°i ·ªü trong t∆∞ th·∫ø tho·∫£i m√°i v√† an to√†n, tr√°nh di chuy·ªÉn n·∫øu kh√¥ng c·∫ßn thi·∫øt.\n2. Ki·ªÉm tra kh·∫£ nƒÉng ph·∫£n ·ª©ng c·ªßa b√† ngo·∫°i b·∫±ng c√°ch g·ªçi t√™n v√† h·ªèi nh·ªØng c√¢u ƒë∆°n gi·∫£n.\n3. Quan s√°t v√† ghi nh·∫≠n c√°c tri·ªáu ch·ª©ng nh∆∞ m√©o m·∫∑t, kh√≥ n√≥i, ƒë·ªÉ b√°o c√°o cho nh√¢n vi√™n y t·∫ø khi h·ªç ƒë·∫øn.\n4. N·∫øu b√† ngo·∫°i c√≥ kh√≥ khƒÉn trong vi·ªác th·ªü, h√£y n√¢ng cao ƒë·∫ßu v√† vai c·ªßa b√† ƒë·ªÉ gi√∫p b√† th·ªü d·ªÖ d√†ng h∆°n.\n5. Gi·ªØ b√¨nh tƒ©nh v√† ƒë·ªông vi√™n b√† ngo·∫°i, tr√°nh l√†m b√† ho·∫£ng s·ª£ ho·∫∑c lo l·∫Øng th√™m.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "423 Tr·∫ßn H∆∞ng ƒê·∫°o, Ph∆∞·ªùng 14, Qu·∫≠n 5, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0943201269"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 423 Tr·∫ßn H∆∞ng ƒê·∫°o, Ph∆∞·ªùng 14, Qu·∫≠n 5, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0943201269\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "1 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 423 Tr·∫ßn H∆∞ng ƒê·∫°o, Ph∆∞·ªùng 14, Qu·∫≠n 5, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0943201269\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201233-16FY ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 423 Tr·∫ßn H∆∞ng ƒê·∫°o, Ph∆∞·ªùng 14, Qu·∫≠n 5, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0943201269\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_MED_003",
      "name": "Medical Emergency: C√≥ ng∆∞·ªùi ƒëang l√™n c∆°n ƒëau tim!...",
      "category": "medical_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ ng∆∞·ªùi ƒëang l√™n c∆°n ƒëau tim! ƒêau ng·ª±c, kh√≥ th·ªü!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·ª° n·∫°n nh√¢n n·∫±m xu·ªëng, n√¢ng ch√¢n cao h∆°n ƒë·∫ßu ƒë·ªÉ c·∫£i thi·ªán l∆∞u th√¥ng m√°u.\n2. ƒê·∫Øp chƒÉn gi·ªØ ·∫•m cho n·∫°n nh√¢n ƒë·ªÉ tr√°nh s·ªëc do m·∫•t nhi·ªát.\n3. N·∫øu n·∫°n nh√¢n m·∫•t √Ω th·ª©c v√† ng∆∞ng th·ªü, th·ª±c hi·ªán h·ªìi sinh tim ph·ªïi CPR.\n4. B·∫£o ƒë·∫£m n·∫°n nh√¢n ·ªü trong t∆∞ th·∫ø tho·∫£i m√°i nh·∫•t c√≥ th·ªÉ, tr√°nh ƒë·ªÉ h·ªç n·∫±m tr√™n m·∫∑t ph·∫≥ng c·ª©ng ho·∫∑c l·∫°nh.\n5. Theo d√µi ch·∫∑t ch·∫Ω t√¨nh tr·∫°ng c·ªßa n·∫°n nh√¢n cho ƒë·∫øn khi nh√¢n vi√™n y t·∫ø ƒë·∫øn n∆°i.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "provide_first_aid"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "MEDICAL"
            ]
          },
          "validation_passed": [
            "Should detect ['MEDICAL']",
            "Should mention: ƒëau tim, ngh·ªâ ng∆°i"
          ],
          "validation_failed": [],
          "duration_ms": 6518.396377563477,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "10 V√µ VƒÉn T·∫ßn, Ph∆∞·ªùng 2, Qu·∫≠n 10, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "10 V√µ VƒÉn T·∫ßn, Ph∆∞·ªùng 2, Qu·∫≠n 10, TP.HCM",
              "address": "10 V√µ VƒÉn T·∫ßn",
              "ward": "Ph∆∞·ªùng 2",
              "district": "Qu·∫≠n 10",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1667.8271293640137,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0919075209",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 10 V√µ VƒÉn T·∫ßn, Ph∆∞·ªùng 2, Qu·∫≠n 10, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0919075209\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "phone",
          "extractions": {
            "phone": "0919075209"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 1966.993808746338,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "1 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 10 V√µ VƒÉn T·∫ßn, Ph∆∞·ªùng 2, Qu·∫≠n 10, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0919075209\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 1
            }
          },
          "validation_passed": [
            "Should extract affected people correctly"
          ],
          "validation_failed": [],
          "duration_ms": 2722.4388122558594,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201315-G5T2 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 10 V√µ VƒÉn T·∫ßn, Ph∆∞·ªùng 2, Qu·∫≠n 10, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0919075209\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket",
            "Should dispatch ambulance"
          ],
          "validation_failed": [],
          "duration_ms": 6436.767578125,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-201315-G5T2",
      "metrics": {
        "workflow_completion": 0.6789166283584793,
        "conversation_coherence": 0.8584223518967395,
        "state_transition": 0.9223341471671567,
        "information_extraction": 0.8608124897881095,
        "correction_handling": 0.8935222135694939,
        "first_aid_guidance": 0.7712315738291378
      },
      "overall_passed": true,
      "total_duration_ms": 42482.89,
      "timestamp": "2026-01-04T03:12:58.037246",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ ng∆∞·ªùi ƒëang l√™n c∆°n ƒëau tim! ƒêau ng·ª±c, kh√≥ th·ªü!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·ª° n·∫°n nh√¢n n·∫±m xu·ªëng, n√¢ng ch√¢n cao h∆°n ƒë·∫ßu ƒë·ªÉ c·∫£i thi·ªán l∆∞u th√¥ng m√°u.\n2. ƒê·∫Øp chƒÉn gi·ªØ ·∫•m cho n·∫°n nh√¢n ƒë·ªÉ tr√°nh s·ªëc do m·∫•t nhi·ªát.\n3. N·∫øu n·∫°n nh√¢n m·∫•t √Ω th·ª©c v√† ng∆∞ng th·ªü, th·ª±c hi·ªán h·ªìi sinh tim ph·ªïi CPR.\n4. B·∫£o ƒë·∫£m n·∫°n nh√¢n ·ªü trong t∆∞ th·∫ø tho·∫£i m√°i nh·∫•t c√≥ th·ªÉ, tr√°nh ƒë·ªÉ h·ªç n·∫±m tr√™n m·∫∑t ph·∫≥ng c·ª©ng ho·∫∑c l·∫°nh.\n5. Theo d√µi ch·∫∑t ch·∫Ω t√¨nh tr·∫°ng c·ªßa n·∫°n nh√¢n cho ƒë·∫øn khi nh√¢n vi√™n y t·∫ø ƒë·∫øn n∆°i.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "10 V√µ VƒÉn T·∫ßn, Ph∆∞·ªùng 2, Qu·∫≠n 10, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0919075209"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 10 V√µ VƒÉn T·∫ßn, Ph∆∞·ªùng 2, Qu·∫≠n 10, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0919075209\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "1 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 10 V√µ VƒÉn T·∫ßn, Ph∆∞·ªùng 2, Qu·∫≠n 10, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0919075209\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201315-G5T2 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 10 V√µ VƒÉn T·∫ßn, Ph∆∞·ªùng 2, Qu·∫≠n 10, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0919075209\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_MED_004",
      "name": "Medical Emergency: Tr·∫ª con b·ªã s·∫∑c ƒë·ªì ƒÉn! M·∫∑t t√≠m ...",
      "category": "medical_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "Tr·∫ª con b·ªã s·∫∑c ƒë·ªì ƒÉn! M·∫∑t t√≠m t√°i, kh√¥ng th·ªü ƒë∆∞·ª£c!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫∑t tr·∫ª n·∫±m ng·ª≠a, s·ª≠ d·ª•ng m·ªôt tay ƒë·∫∑t d∆∞·ªõi c·∫±m v√† n√¢ng c·∫±m l√™n; tay c√≤n l·∫°i ƒë·∫∑t tr√™n tr√°n v√† √©p xu·ªëng d∆∞·ªõi v√† v·ªÅ ph√≠a th√¢n ƒë·ªÉ m·ªü ƒë∆∞·ªùng th·ªü.\n2. Ki·ªÉm tra mi·ªáng n·∫°n nh√¢n xem c√≥ v·∫≠t c·∫£n n√†o kh√¥ng v√† n·∫øu c√≥ th·ªÉ, nh·∫π nh√†ng lo·∫°i b·ªè n√≥ n·∫øu th·∫•y r√µ.\n3. N·∫øu tr·∫ª kh√¥ng th·ªü, √°p d·ª•ng ph∆∞∆°ng ph√°p \"H√† h∆°i th·ªïi ng·∫°t\": M·ªôt tay b·ªãt m≈©i n·∫°n nh√¢n, tay c√≤n l·∫°i n√¢ng c·∫±m v√† k√©o h√†m xu·ªëng ƒë·ªÉ m·ªü mi·ªáng n·∫°n nh√¢n, sau ƒë√≥ th·ªïi li√™n ti·∫øp 2 c√°i h∆°i v√†o mi·ªáng n·∫°n nh√¢n.\n4. N·∫øu kh√¥ng c√≥ ph·∫£n ·ª©ng, th·ª±c hi·ªán thao t√°c √©p tim: D√πng l·ª±c ph·∫ßn th√¢n tr√™n, √©p l·ªìng ng·ª±c v·ªõi ƒë·ªô s√¢u 5 - 6 cm, √©p nhanh v√† m·∫°nh, kh√¥ng gi√°n ƒëo·∫°n v√† ƒë·ªÉ l·ªìng ng·ª±c ph·ªìng l√™n sau m·ªói l·∫ßn √©p (t·∫ßn s·ªë √©p tim l√† 100 - 120 l·∫ßn/ph√∫t).\n5. ƒê·ªïi ng∆∞·ªùi √©p tim - th·ªïi ng·∫°t m·ªói 2 ph√∫t n·∫øu c√≥ ng∆∞·ªùi h·ªó tr·ª£, ki√™n tr√¨ cho t·ªõi khi c√≥ d·∫•u hi·ªáu t·ªânh l·∫°i.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "provide_first_aid"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "MEDICAL"
            ]
          },
          "validation_passed": [
            "Should mention: s·∫∑c, Heimlich"
          ],
          "validation_failed": [
            "Should detect ['MEDICAL']"
          ],
          "duration_ms": 9981.79578781128,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "332 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 3, Qu·∫≠n 4, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "332 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 3, Qu·∫≠n 4, TP.HCM",
              "address": "332 Hai B√† Tr∆∞ng",
              "ward": "Ph∆∞·ªùng 3",
              "district": "Qu·∫≠n 4",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1671.2894439697266,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0585428425",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 332 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 3, Qu·∫≠n 4, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0585428425\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "phone",
          "extractions": {
            "phone": "0585428425"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 1358.144998550415,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "1 b√©",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 332 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 3, Qu·∫≠n 4, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0585428425\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 1,
              "critical": 1
            }
          },
          "validation_passed": [
            "Should extract affected people correctly"
          ],
          "validation_failed": [],
          "duration_ms": 2584.2528343200684,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201401-D7ZE ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 332 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 3, Qu·∫≠n 4, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0585428425\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket",
            "Should dispatch ambulance"
          ],
          "validation_failed": [],
          "duration_ms": 6640.439987182617,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-201401-D7ZE",
      "metrics": {
        "workflow_completion": 0.681064579028317,
        "conversation_coherence": 0.8556889013421554,
        "state_transition": 0.891669405533397,
        "information_extraction": 0.8934548988162865,
        "correction_handling": 0.7270089651532622,
        "first_aid_guidance": 0.6840002815422742
      },
      "overall_passed": true,
      "total_duration_ms": 46072.515,
      "timestamp": "2026-01-04T03:13:40.520380",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "Tr·∫ª con b·ªã s·∫∑c ƒë·ªì ƒÉn! M·∫∑t t√≠m t√°i, kh√¥ng th·ªü ƒë∆∞·ª£c!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫∑t tr·∫ª n·∫±m ng·ª≠a, s·ª≠ d·ª•ng m·ªôt tay ƒë·∫∑t d∆∞·ªõi c·∫±m v√† n√¢ng c·∫±m l√™n; tay c√≤n l·∫°i ƒë·∫∑t tr√™n tr√°n v√† √©p xu·ªëng d∆∞·ªõi v√† v·ªÅ ph√≠a th√¢n ƒë·ªÉ m·ªü ƒë∆∞·ªùng th·ªü.\n2. Ki·ªÉm tra mi·ªáng n·∫°n nh√¢n xem c√≥ v·∫≠t c·∫£n n√†o kh√¥ng v√† n·∫øu c√≥ th·ªÉ, nh·∫π nh√†ng lo·∫°i b·ªè n√≥ n·∫øu th·∫•y r√µ.\n3. N·∫øu tr·∫ª kh√¥ng th·ªü, √°p d·ª•ng ph∆∞∆°ng ph√°p \"H√† h∆°i th·ªïi ng·∫°t\": M·ªôt tay b·ªãt m≈©i n·∫°n nh√¢n, tay c√≤n l·∫°i n√¢ng c·∫±m v√† k√©o h√†m xu·ªëng ƒë·ªÉ m·ªü mi·ªáng n·∫°n nh√¢n, sau ƒë√≥ th·ªïi li√™n ti·∫øp 2 c√°i h∆°i v√†o mi·ªáng n·∫°n nh√¢n.\n4. N·∫øu kh√¥ng c√≥ ph·∫£n ·ª©ng, th·ª±c hi·ªán thao t√°c √©p tim: D√πng l·ª±c ph·∫ßn th√¢n tr√™n, √©p l·ªìng ng·ª±c v·ªõi ƒë·ªô s√¢u 5 - 6 cm, √©p nhanh v√† m·∫°nh, kh√¥ng gi√°n ƒëo·∫°n v√† ƒë·ªÉ l·ªìng ng·ª±c ph·ªìng l√™n sau m·ªói l·∫ßn √©p (t·∫ßn s·ªë √©p tim l√† 100 - 120 l·∫ßn/ph√∫t).\n5. ƒê·ªïi ng∆∞·ªùi √©p tim - th·ªïi ng·∫°t m·ªói 2 ph√∫t n·∫øu c√≥ ng∆∞·ªùi h·ªó tr·ª£, ki√™n tr√¨ cho t·ªõi khi c√≥ d·∫•u hi·ªáu t·ªânh l·∫°i.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "332 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 3, Qu·∫≠n 4, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0585428425"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 332 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 3, Qu·∫≠n 4, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0585428425\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "1 b√©"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 332 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 3, Qu·∫≠n 4, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0585428425\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201401-D7ZE ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 332 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 3, Qu·∫≠n 4, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0585428425\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_MED_005",
      "name": "Medical Emergency: C√≥ ng∆∞·ªùi ng√£ t·ª´ t·∫ßng 2 xu·ªëng! ...",
      "category": "medical_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ ng∆∞·ªùi ng√£ t·ª´ t·∫ßng 2 xu·ªëng! N·∫±m b·∫•t ƒë·ªông!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. Kh√¥ng di chuy·ªÉn n·∫°n nh√¢n, ƒë·ªÉ n·∫°n nh√¢n n·∫±m b·∫•t ƒë·ªông t·∫°i ch·ªó.\n2. Kh√¥ng t√°c ƒë·ªông b·∫•t k√¨ l·ª±c n√†o l√™n v√πng c·ªôt s·ªëng c·ªï, c·ªôt s·ªëng l∆∞ng c·ªßa n·∫°n nh√¢n.\n3. Tr·∫•n an n·∫°n nh√¢n gi√∫p n·∫°n nh√¢n gi·ªØ b√¨nh tƒ©nh.\n4. Gi·ªØ nguy√™n t∆∞ th·∫ø b·∫•t ƒë·ªông c·ªßa n·∫°n nh√¢n ƒë·∫øn khi xe c·ª©u th∆∞∆°ng ƒë·∫øn.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "provide_first_aid"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "MEDICAL"
            ]
          },
          "validation_passed": [
            "Should mention: ch·∫•n th∆∞∆°ng, kh√¥ng di chuy·ªÉn"
          ],
          "validation_failed": [
            "Should detect ['MEDICAL']"
          ],
          "duration_ms": 4891.1919593811035,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "353 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 14, Qu·∫≠n Ph√∫ Nhu·∫≠n, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "353 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 14, Qu·∫≠n Ph√∫ Nhu·∫≠n, TP.HCM",
              "address": "353 Nguy·ªÖn Hu·ªá",
              "ward": "Ph∆∞·ªùng 14",
              "district": "Qu·∫≠n Ph√∫ Nhu·∫≠n",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1488.7897968292236,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0896373664",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 353 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 14, Qu·∫≠n Ph√∫ Nhu·∫≠n, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0896373664\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "phone",
          "extractions": {
            "phone": "0896373664"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 852.82301902771,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "1 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 353 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 14, Qu·∫≠n Ph√∫ Nhu·∫≠n, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0896373664\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 1,
              "critical": 1
            }
          },
          "validation_passed": [
            "Should extract affected people correctly"
          ],
          "validation_failed": [],
          "duration_ms": 2199.2976665496826,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201441-LEE7 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 353 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 14, Qu·∫≠n Ph√∫ Nhu·∫≠n, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0896373664\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket",
            "Should dispatch ambulance"
          ],
          "validation_failed": [],
          "duration_ms": 7835.5982303619385,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-201441-LEE7",
      "metrics": {
        "workflow_completion": 0.7180056351033165,
        "conversation_coherence": 0.8440863362894951,
        "state_transition": 0.9271604416916341,
        "information_extraction": 0.8820264106166608,
        "correction_handling": 0.9094735485639948,
        "first_aid_guidance": 0.8970637543410861
      },
      "overall_passed": true,
      "total_duration_ms": 41417.806,
      "timestamp": "2026-01-04T03:14:26.593123",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ ng∆∞·ªùi ng√£ t·ª´ t·∫ßng 2 xu·ªëng! N·∫±m b·∫•t ƒë·ªông!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. Kh√¥ng di chuy·ªÉn n·∫°n nh√¢n, ƒë·ªÉ n·∫°n nh√¢n n·∫±m b·∫•t ƒë·ªông t·∫°i ch·ªó.\n2. Kh√¥ng t√°c ƒë·ªông b·∫•t k√¨ l·ª±c n√†o l√™n v√πng c·ªôt s·ªëng c·ªï, c·ªôt s·ªëng l∆∞ng c·ªßa n·∫°n nh√¢n.\n3. Tr·∫•n an n·∫°n nh√¢n gi√∫p n·∫°n nh√¢n gi·ªØ b√¨nh tƒ©nh.\n4. Gi·ªØ nguy√™n t∆∞ th·∫ø b·∫•t ƒë·ªông c·ªßa n·∫°n nh√¢n ƒë·∫øn khi xe c·ª©u th∆∞∆°ng ƒë·∫øn.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "353 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 14, Qu·∫≠n Ph√∫ Nhu·∫≠n, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0896373664"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 353 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 14, Qu·∫≠n Ph√∫ Nhu·∫≠n, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0896373664\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "1 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 353 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 14, Qu·∫≠n Ph√∫ Nhu·∫≠n, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0896373664\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201441-LEE7 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 353 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 14, Qu·∫≠n Ph√∫ Nhu·∫≠n, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0896373664\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_MED_006",
      "name": "Medical Emergency: Ng∆∞·ªùi b·ªã ƒëi·ªán gi·∫≠t! ƒêang b·∫•t t...",
      "category": "medical_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "Ng∆∞·ªùi b·ªã ƒëi·ªán gi·∫≠t! ƒêang b·∫•t t·ªânh!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. Ng·∫Øt ngu·ªìn ƒëi·ªán ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† n·∫°n nh√¢n.\n2. T√°ch n·∫°n nh√¢n ra kh·ªèi ngu·ªìn ƒëi·ªán b·∫±ng c√°c v·∫≠t d·ª•ng c√°ch ƒëi·ªán nh∆∞ thanh g·ªó hay nh·ª±a.\n3. Ki·ªÉm tra t√¨nh tr·∫°ng c·ªßa n·∫°n nh√¢n, bao g·ªìm h∆°i th·ªü v√† m·∫°ch ƒë·∫≠p.\n4. N·∫øu n·∫°n nh√¢n kh√¥ng th·ªü, ti·∫øn h√†nh h·ªìi sinh tim ph·ªïi c∆° b·∫£n (n·∫øu b·∫°n ƒë√£ ƒë∆∞·ª£c ƒë√†o t·∫°o).\n5. ƒê·∫£m b·∫£o n·∫°n nh√¢n ·ªü trong t∆∞ th·∫ø tho·∫£i m√°i v√† an to√†n, tr√°nh di chuy·ªÉn n·∫°n nh√¢n n·∫øu kh√¥ng c·∫ßn thi·∫øt ƒë·ªÉ tr√°nh l√†m t·ªïn th∆∞∆°ng th√™m.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "provide_first_aid"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "MEDICAL",
              "FIRE_RESCUE"
            ]
          },
          "validation_passed": [
            "Should mention: ƒëi·ªán gi·∫≠t, ng·∫Øt ngu·ªìn ƒëi·ªán"
          ],
          "validation_failed": [
            "Should detect ['MEDICAL', 'FIRE_RESCUE']"
          ],
          "duration_ms": 6838.720083236694,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "83 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán B√¨nh Ch√°nh, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "83 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán B√¨nh Ch√°nh, TP.HCM",
              "address": "83 C√°ch M·∫°ng Th√°ng 8",
              "ward": "Ph∆∞·ªùng 4",
              "district": "Huy·ªán B√¨nh Ch√°nh",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 2053.3406734466553,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0591894786",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 83 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán B√¨nh Ch√°nh, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0591894786\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "phone",
          "extractions": {
            "phone": "0591894786"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 868.2162761688232,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "1 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 83 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán B√¨nh Ch√°nh, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0591894786\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 1,
              "critical": 1
            }
          },
          "validation_passed": [
            "Should extract affected people correctly"
          ],
          "validation_failed": [],
          "duration_ms": 2629.143476486206,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201525-BIZ0 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 83 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán B√¨nh Ch√°nh, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0591894786\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket",
            "Should dispatch ambulance"
          ],
          "validation_failed": [],
          "duration_ms": 6519.509553909302,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-201525-BIZ0",
      "metrics": {
        "workflow_completion": 0.4891883488697487,
        "conversation_coherence": 0.8731058572770513,
        "state_transition": 0.9310577281751238,
        "information_extraction": 0.5665045787611986,
        "correction_handling": 0.916781569687276,
        "first_aid_guidance": 0.886995974062567
      },
      "overall_passed": false,
      "total_duration_ms": 45675.032999999996,
      "timestamp": "2026-01-04T03:15:08.011259",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "Ng∆∞·ªùi b·ªã ƒëi·ªán gi·∫≠t! ƒêang b·∫•t t·ªânh!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. Ng·∫Øt ngu·ªìn ƒëi·ªán ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† n·∫°n nh√¢n.\n2. T√°ch n·∫°n nh√¢n ra kh·ªèi ngu·ªìn ƒëi·ªán b·∫±ng c√°c v·∫≠t d·ª•ng c√°ch ƒëi·ªán nh∆∞ thanh g·ªó hay nh·ª±a.\n3. Ki·ªÉm tra t√¨nh tr·∫°ng c·ªßa n·∫°n nh√¢n, bao g·ªìm h∆°i th·ªü v√† m·∫°ch ƒë·∫≠p.\n4. N·∫øu n·∫°n nh√¢n kh√¥ng th·ªü, ti·∫øn h√†nh h·ªìi sinh tim ph·ªïi c∆° b·∫£n (n·∫øu b·∫°n ƒë√£ ƒë∆∞·ª£c ƒë√†o t·∫°o).\n5. ƒê·∫£m b·∫£o n·∫°n nh√¢n ·ªü trong t∆∞ th·∫ø tho·∫£i m√°i v√† an to√†n, tr√°nh di chuy·ªÉn n·∫°n nh√¢n n·∫øu kh√¥ng c·∫ßn thi·∫øt ƒë·ªÉ tr√°nh l√†m t·ªïn th∆∞∆°ng th√™m.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "83 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán B√¨nh Ch√°nh, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0591894786"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 83 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán B√¨nh Ch√°nh, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0591894786\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "1 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 83 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán B√¨nh Ch√°nh, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0591894786\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201525-BIZ0 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 83 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán B√¨nh Ch√°nh, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0591894786\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_MED_007",
      "name": "Medical Emergency: C√≥ ng∆∞·ªùi b·ªã r·∫Øn c·∫Øn! Ch√¢n s∆∞ng...",
      "category": "medical_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ ng∆∞·ªùi b·ªã r·∫Øn c·∫Øn! Ch√¢n s∆∞ng to, ƒëau nhi·ªÅu!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·ªông vi√™n ng∆∞·ªùi b·ªã n·∫°n b√¨nh tƒ©nh v√¨ c√†ng ho·∫£ng lo·∫°n n·ªçc ƒë·ªôc s·∫Ω c√†ng lan ra nhanh h∆°n.\n2. C·ªüi b·ªè qu·∫ßn √°o, ƒë·ªì trang s·ª©c ƒë·ªÅ ph√≤ng t√¨nh tr·∫°ng s∆∞ng n·ªÅ c√≥ th·ªÉ di·ªÖn ra sau ƒë√≥.\n3. ƒê·ªÉ v·ªã tr√≠ v·∫øt c·∫Øn th·∫•p h∆°n tim ƒë·ªÉ h·∫°n ch·∫ø ch·∫•t ƒë·ªôc ph√°t t√°c.\n4. H·∫°n ch·∫ø v·∫≠n ƒë·ªông v√† tr√°nh v√πng ho·∫°t ƒë·ªông c·ªßa r·∫Øn.\n5. Kh√¥ng garo, kh√¥ng tr√≠ch r·∫°ch v√† h√∫t n·ªçc ƒë·ªôc, kh√¥ng b√¥i m·ª° hay ƒë·∫Øp thu·ªëc l√™n v·∫øt th∆∞∆°ng, v√† kh√¥ng c·ªë b·∫Øt r·∫Øn.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "provide_first_aid"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "MEDICAL"
            ]
          },
          "validation_passed": [
            "Should mention: r·∫Øn c·∫Øn, gi·ªØ y√™n"
          ],
          "validation_failed": [
            "Should detect ['MEDICAL']"
          ],
          "duration_ms": 6591.52626991272,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "141 L√™ L·ª£i, Ph∆∞·ªùng 1, Qu·∫≠n Th·ªß ƒê·ª©c, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "141 L√™ L·ª£i, Ph∆∞·ªùng 1, Qu·∫≠n Th·ªß ƒê·ª©c, TP.HCM",
              "address": "141 L√™ L·ª£i",
              "ward": "Ph∆∞·ªùng 1",
              "district": "Qu·∫≠n Th·ªß ƒê·ª©c",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1551.8558025360107,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0942092118",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 141 L√™ L·ª£i, Ph∆∞·ªùng 1, Qu·∫≠n Th·ªß ƒê·ª©c, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0942092118\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "phone",
          "extractions": {
            "phone": "0942092118"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 972.135066986084,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "1 ng∆∞·ªùi",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": null,
          "extractions": {
            "affectedPeople": {
              "total": 1
            }
          },
          "validation_passed": [
            "Should extract affected people correctly"
          ],
          "validation_failed": [],
          "duration_ms": 17.008304595947266,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": null,
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should dispatch ambulance"
          ],
          "validation_failed": [
            "Should create ticket"
          ],
          "duration_ms": 17.333269119262695,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": false,
      "ticket_created": false,
      "ticket_id": null,
      "metrics": {
        "workflow_completion": 0.29845238974019017,
        "conversation_coherence": 0.49015841391723586,
        "state_transition": 0.4159096159692294,
        "information_extraction": 0.3068151621279509,
        "correction_handling": 0.18405523823901576,
        "first_aid_guidance": 0.7286208290786955
      },
      "overall_passed": false,
      "total_duration_ms": 31355.810999999998,
      "timestamp": "2026-01-04T03:15:53.686475",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ ng∆∞·ªùi b·ªã r·∫Øn c·∫Øn! Ch√¢n s∆∞ng to, ƒëau nhi·ªÅu!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·ªông vi√™n ng∆∞·ªùi b·ªã n·∫°n b√¨nh tƒ©nh v√¨ c√†ng ho·∫£ng lo·∫°n n·ªçc ƒë·ªôc s·∫Ω c√†ng lan ra nhanh h∆°n.\n2. C·ªüi b·ªè qu·∫ßn √°o, ƒë·ªì trang s·ª©c ƒë·ªÅ ph√≤ng t√¨nh tr·∫°ng s∆∞ng n·ªÅ c√≥ th·ªÉ di·ªÖn ra sau ƒë√≥.\n3. ƒê·ªÉ v·ªã tr√≠ v·∫øt c·∫Øn th·∫•p h∆°n tim ƒë·ªÉ h·∫°n ch·∫ø ch·∫•t ƒë·ªôc ph√°t t√°c.\n4. H·∫°n ch·∫ø v·∫≠n ƒë·ªông v√† tr√°nh v√πng ho·∫°t ƒë·ªông c·ªßa r·∫Øn.\n5. Kh√¥ng garo, kh√¥ng tr√≠ch r·∫°ch v√† h√∫t n·ªçc ƒë·ªôc, kh√¥ng b√¥i m·ª° hay ƒë·∫Øp thu·ªëc l√™n v·∫øt th∆∞∆°ng, v√† kh√¥ng c·ªë b·∫Øt r·∫Øn.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "141 L√™ L·ª£i, Ph∆∞·ªùng 1, Qu·∫≠n Th·ªß ƒê·ª©c, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0942092118"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 141 L√™ L·ª£i, Ph∆∞·ªùng 1, Qu·∫≠n Th·ªß ƒê·ª©c, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0942092118\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "1 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        }
      ]
    },
    {
      "test_case_id": "MULTI_MED_008",
      "name": "Medical Emergency: Tai n·∫°n xe kh√°ch! Nhi·ªÅu ng∆∞·ªùi ...",
      "category": "medical_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "Tai n·∫°n xe kh√°ch! Nhi·ªÅu ng∆∞·ªùi b·ªã th∆∞∆°ng!",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "detect_emergency_type",
            "provide_first_aid"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": null,
          "extractions": {
            "emergencyTypes": [
              "MEDICAL"
            ]
          },
          "validation_passed": [
            "Should mention: tai n·∫°n, s∆° c·ª©u"
          ],
          "validation_failed": [
            "Should detect ['MEDICAL']"
          ],
          "duration_ms": 24.734973907470703,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "294 V√µ VƒÉn T·∫ßn, Ph∆∞·ªùng 5, Qu·∫≠n 2, TP.HCM",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": null,
          "extractions": {
            "location": {
              "full": "294 V√µ VƒÉn T·∫ßn, Ph∆∞·ªùng 5, Qu·∫≠n 2, TP.HCM",
              "address": "294 V√µ VƒÉn T·∫ßn",
              "ward": "Ph∆∞·ªùng 5",
              "district": "Qu·∫≠n 2",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 16.620874404907227,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0701707153",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": null,
          "extractions": {
            "phone": "0701707153"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 17.51089096069336,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "Kho·∫£ng 10 ng∆∞·ªùi, 3 ng∆∞·ªùi n·∫∑ng",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": null,
          "extractions": {
            "affectedPeople": {
              "total": 10,
              "injured": 7,
              "critical": 3
            }
          },
          "validation_passed": [
            "Should extract affected people correctly"
          ],
          "validation_failed": [],
          "duration_ms": 3.2677650451660156,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": null,
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should dispatch ambulance"
          ],
          "validation_failed": [
            "Should create ticket"
          ],
          "duration_ms": 3.3278465270996094,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": false,
      "ticket_created": false,
      "ticket_id": null,
      "metrics": {
        "workflow_completion": 0.018897317216633732,
        "conversation_coherence": 0.07224326634262515,
        "state_transition": 0.0,
        "information_extraction": 0.04621734508305542,
        "correction_handling": 0.011920293453832883,
        "first_aid_guidance": 0.004742587654349034
      },
      "overall_passed": false,
      "total_duration_ms": 19730.358,
      "timestamp": "2026-01-04T03:16:25.042376",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "Tai n·∫°n xe kh√°ch! Nhi·ªÅu ng∆∞·ªùi b·ªã th∆∞∆°ng!"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "294 V√µ VƒÉn T·∫ßn, Ph∆∞·ªùng 5, Qu·∫≠n 2, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "0701707153"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "Kho·∫£ng 10 ng∆∞·ªùi, 3 ng∆∞·ªùi n·∫∑ng"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        }
      ]
    },
    {
      "test_case_id": "MULTI_MED_009",
      "name": "Medical Emergency: C√≥ ng∆∞·ªùi b·ªã ng·ªô ƒë·ªôc th·ª±c ph·∫©m!...",
      "category": "medical_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ ng∆∞·ªùi b·ªã ng·ªô ƒë·ªôc th·ª±c ph·∫©m! N√¥n m·ª≠a, co gi·∫≠t!",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "detect_emergency_type",
            "provide_first_aid"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": null,
          "extractions": {
            "emergencyTypes": [
              "MEDICAL"
            ]
          },
          "validation_passed": [
            "Should mention: ng·ªô ƒë·ªôc, kh√¥ng g√¢y n√¥n"
          ],
          "validation_failed": [
            "Should detect ['MEDICAL']"
          ],
          "duration_ms": 17.325162887573242,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "302 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 14, Huy·ªán C·ªß Chi, TP.HCM",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": null,
          "extractions": {
            "location": {
              "full": "302 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 14, Huy·ªán C·ªß Chi, TP.HCM",
              "address": "302 ƒêi·ªán Bi√™n Ph·ªß",
              "ward": "Ph∆∞·ªùng 14",
              "district": "Huy·ªán C·ªß Chi",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 2.6063919067382812,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0914244210",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": null,
          "extractions": {
            "phone": "0914244210"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 16.51620864868164,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "4 ng∆∞·ªùi c√πng b√†n",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": null,
          "extractions": {
            "affectedPeople": {
              "total": 4
            }
          },
          "validation_passed": [
            "Should extract affected people correctly"
          ],
          "validation_failed": [],
          "duration_ms": 2.882719039916992,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": null,
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should dispatch ambulance"
          ],
          "validation_failed": [
            "Should create ticket"
          ],
          "duration_ms": 2.820730209350586,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": false,
      "ticket_created": false,
      "ticket_id": null,
      "metrics": {
        "workflow_completion": 0.019218047516533266,
        "conversation_coherence": 0.08097791105034804,
        "state_transition": 0.0,
        "information_extraction": 0.051890085705822445,
        "correction_handling": 0.03771845068692896,
        "first_aid_guidance": 0.0022977370160917328
      },
      "overall_passed": false,
      "total_duration_ms": 20696.504,
      "timestamp": "2026-01-04T03:16:44.772950",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ ng∆∞·ªùi b·ªã ng·ªô ƒë·ªôc th·ª±c ph·∫©m! N√¥n m·ª≠a, co gi·∫≠t!"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "302 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 14, Huy·ªán C·ªß Chi, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "0914244210"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "4 ng∆∞·ªùi c√πng b√†n"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        }
      ]
    },
    {
      "test_case_id": "MULTI_MED_010",
      "name": "Medical Emergency: Ng∆∞·ªùi b·ªã ƒëu·ªëi n∆∞·ªõc! V·ª´a v·ªõt l√™...",
      "category": "medical_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "Ng∆∞·ªùi b·ªã ƒëu·ªëi n∆∞·ªõc! V·ª´a v·ªõt l√™n, kh√¥ng th·ªü!",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "detect_emergency_type",
            "provide_first_aid"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": null,
          "extractions": {
            "emergencyTypes": [
              "MEDICAL",
              "FIRE_RESCUE"
            ]
          },
          "validation_passed": [
            "Should mention: ƒëu·ªëi n∆∞·ªõc, CPR"
          ],
          "validation_failed": [
            "Should detect ['MEDICAL', 'FIRE_RESCUE']"
          ],
          "duration_ms": 34.687042236328125,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "327 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 8, Qu·∫≠n 2, TP.HCM",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": null,
          "extractions": {
            "location": {
              "full": "327 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 8, Qu·∫≠n 2, TP.HCM",
              "address": "327 Nguy·ªÖn Hu·ªá",
              "ward": "Ph∆∞·ªùng 8",
              "district": "Qu·∫≠n 2",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 4.051685333251953,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0908409999",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": null,
          "extractions": {
            "phone": "0908409999"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 4.138708114624023,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "1 ng∆∞·ªùi",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": null,
          "extractions": {
            "affectedPeople": {
              "total": 1,
              "critical": 1
            }
          },
          "validation_passed": [
            "Should extract affected people correctly"
          ],
          "validation_failed": [],
          "duration_ms": 4.092216491699219,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": null,
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should dispatch ambulance"
          ],
          "validation_failed": [
            "Should create ticket"
          ],
          "duration_ms": 4.215478897094727,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": false,
      "ticket_created": false,
      "ticket_id": null,
      "metrics": {
        "workflow_completion": 0.02841991929815112,
        "conversation_coherence": 0.1,
        "state_transition": 0.0,
        "information_extraction": 0.055819294945023336,
        "correction_handling": 0.021671368236193624,
        "first_aid_guidance": 0.0025957356208816057
      },
      "overall_passed": false,
      "total_duration_ms": 23529.69,
      "timestamp": "2026-01-04T03:17:05.469773",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "Ng∆∞·ªùi b·ªã ƒëu·ªëi n∆∞·ªõc! V·ª´a v·ªõt l√™n, kh√¥ng th·ªü!"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "327 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 8, Qu·∫≠n 2, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "0908409999"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "1 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        }
      ]
    },
    {
      "test_case_id": "MULTI_SEC_001",
      "name": "Security Emergency: C√≥ k·∫ª tr·ªôm ƒëang ƒë·ªôt nh·∫≠p v√†o n...",
      "category": "security_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ k·∫ª tr·ªôm ƒëang ƒë·ªôt nh·∫≠p v√†o nh√† t√¥i! T√¥i ƒëang tr·ªën trong ph√≤ng!",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "detect_emergency_type",
            "provide_safety_guidance"
          ],
          "expected_next_step": "location",
          "actual_next_step": null,
          "extractions": {
            "emergencyTypes": [
              "SECURITY"
            ]
          },
          "validation_passed": [
            "Should provide safety advice"
          ],
          "validation_failed": [
            "Should detect ['SECURITY']"
          ],
          "duration_ms": 9.80687141418457,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "38 L√™ L·ª£i, Ph∆∞·ªùng 11, Qu·∫≠n 10, TP.HCM",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": null,
          "extractions": {
            "location": {
              "full": "38 L√™ L·ª£i, Ph∆∞·ªùng 11, Qu·∫≠n 10, TP.HCM",
              "address": "38 L√™ L·ª£i",
              "ward": "Ph∆∞·ªùng 11",
              "district": "Qu·∫≠n 10",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 17.77362823486328,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0857849034",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": null,
          "extractions": {
            "phone": "0857849034"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 4.829168319702148,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "1 ng∆∞·ªùi",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": null,
          "extractions": {
            "affectedPeople": {
              "total": 1
            }
          },
          "validation_passed": [
            "Should extract count"
          ],
          "validation_failed": [],
          "duration_ms": 17.054319381713867,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "ƒê√∫ng, nhanh l√™n!",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": null,
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should dispatch police"
          ],
          "validation_failed": [
            "Should create ticket"
          ],
          "duration_ms": 4.074811935424805,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": false,
      "ticket_created": false,
      "ticket_id": null,
      "metrics": {
        "workflow_completion": 0.020968505681408477,
        "conversation_coherence": 0.08740926640312381,
        "state_transition": 0.0,
        "information_extraction": 0.08284654418321782,
        "correction_handling": 0.015577290624807037,
        "first_aid_guidance": 0.010669059749614017
      },
      "overall_passed": false,
      "total_duration_ms": 20397.961,
      "timestamp": "2026-01-04T03:17:29.000150",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ k·∫ª tr·ªôm ƒëang ƒë·ªôt nh·∫≠p v√†o nh√† t√¥i! T√¥i ƒëang tr·ªën trong ph√≤ng!"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "38 L√™ L·ª£i, Ph∆∞·ªùng 11, Qu·∫≠n 10, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "0857849034"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "1 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng, nhanh l√™n!"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        }
      ]
    },
    {
      "test_case_id": "MULTI_SEC_002",
      "name": "Security Emergency: ƒêang b·ªã c∆∞·ªõp! C√≥ dao! C·ª©u t√¥i ...",
      "category": "security_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "ƒêang b·ªã c∆∞·ªõp! C√≥ dao! C·ª©u t√¥i v·ªõi!",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "detect_emergency_type",
            "provide_safety_guidance"
          ],
          "expected_next_step": "location",
          "actual_next_step": null,
          "extractions": {
            "emergencyTypes": [
              "SECURITY"
            ]
          },
          "validation_passed": [
            "Should provide safety advice"
          ],
          "validation_failed": [
            "Should detect ['SECURITY']"
          ],
          "duration_ms": 2.761363983154297,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "265 L√™ L·ª£i, Ph∆∞·ªùng 14, Qu·∫≠n T√¢n Ph√∫, TP.HCM",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": null,
          "extractions": {
            "location": {
              "full": "265 L√™ L·ª£i, Ph∆∞·ªùng 14, Qu·∫≠n T√¢n Ph√∫, TP.HCM",
              "address": "265 L√™ L·ª£i",
              "ward": "Ph∆∞·ªùng 14",
              "district": "Qu·∫≠n T√¢n Ph√∫",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 3.2227039337158203,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0597668702",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": null,
          "extractions": {
            "phone": "0597668702"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 3.7250518798828125,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "2 ng∆∞·ªùi",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": null,
          "extractions": {
            "affectedPeople": {
              "total": 2
            }
          },
          "validation_passed": [
            "Should extract count"
          ],
          "validation_failed": [],
          "duration_ms": 2.5718212127685547,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "ƒê√∫ng, nhanh l√™n!",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": null,
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should dispatch police"
          ],
          "validation_failed": [
            "Should create ticket"
          ],
          "duration_ms": 2.439260482788086,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": false,
      "ticket_created": false,
      "ticket_id": null,
      "metrics": {
        "workflow_completion": 0.03068353946323867,
        "conversation_coherence": 0.10236771861725506,
        "state_transition": 0.0,
        "information_extraction": 0.0858966048872983,
        "correction_handling": 0.020449320242248468,
        "first_aid_guidance": 0.011920292671569665
      },
      "overall_passed": false,
      "total_duration_ms": 19894.655,
      "timestamp": "2026-01-04T03:17:49.398237",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "ƒêang b·ªã c∆∞·ªõp! C√≥ dao! C·ª©u t√¥i v·ªõi!"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "265 L√™ L·ª£i, Ph∆∞·ªùng 14, Qu·∫≠n T√¢n Ph√∫, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "0597668702"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "2 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng, nhanh l√™n!"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        }
      ]
    },
    {
      "test_case_id": "MULTI_SEC_003",
      "name": "Security Emergency: C√≥ nh√≥m ng∆∞·ªùi ƒë√°nh nhau ngo√†i ...",
      "category": "security_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ nh√≥m ng∆∞·ªùi ƒë√°nh nhau ngo√†i ƒë∆∞·ªùng, ƒë√¢m ch√©m nhau!",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "detect_emergency_type",
            "provide_safety_guidance"
          ],
          "expected_next_step": "location",
          "actual_next_step": null,
          "extractions": {
            "emergencyTypes": [
              "SECURITY",
              "MEDICAL"
            ]
          },
          "validation_passed": [
            "Should provide safety advice"
          ],
          "validation_failed": [
            "Should detect ['SECURITY', 'MEDICAL']"
          ],
          "duration_ms": 3.341197967529297,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "463 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 4, Qu·∫≠n T√¢n Ph√∫, TP.HCM",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": null,
          "extractions": {
            "location": {
              "full": "463 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 4, Qu·∫≠n T√¢n Ph√∫, TP.HCM",
              "address": "463 ƒêi·ªán Bi√™n Ph·ªß",
              "ward": "Ph∆∞·ªùng 4",
              "district": "Qu·∫≠n T√¢n Ph√∫",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 3.9412975311279297,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0355041623",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": null,
          "extractions": {
            "phone": "0355041623"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 7.090568542480469,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "3 ng∆∞·ªùi",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": null,
          "extractions": {
            "affectedPeople": {
              "total": 3
            }
          },
          "validation_passed": [
            "Should extract count"
          ],
          "validation_failed": [],
          "duration_ms": 16.94631576538086,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "ƒê√∫ng, nhanh l√™n!",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": null,
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should dispatch police"
          ],
          "validation_failed": [
            "Should create ticket"
          ],
          "duration_ms": 3.5638809204101562,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": false,
      "ticket_created": false,
      "ticket_id": null,
      "metrics": {
        "workflow_completion": 0.01329642419157059,
        "conversation_coherence": 0.10491872682952305,
        "state_transition": 0.0010986941699556434,
        "information_extraction": 0.04608101767537327,
        "correction_handling": 0.006754669770938672,
        "first_aid_guidance": 0.023111625985781887
      },
      "overall_passed": false,
      "total_duration_ms": 20620.159,
      "timestamp": "2026-01-04T03:18:09.293181",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ nh√≥m ng∆∞·ªùi ƒë√°nh nhau ngo√†i ƒë∆∞·ªùng, ƒë√¢m ch√©m nhau!"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "463 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 4, Qu·∫≠n T√¢n Ph√∫, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "0355041623"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "3 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng, nhanh l√™n!"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        }
      ]
    },
    {
      "test_case_id": "MULTI_SEC_004",
      "name": "Security Emergency: C√≥ ng∆∞·ªùi say r∆∞·ª£u ƒëang ƒë·∫≠p ph√°...",
      "category": "security_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ ng∆∞·ªùi say r∆∞·ª£u ƒëang ƒë·∫≠p ph√° qu√°n, ƒëe d·ªça m·ªçi ng∆∞·ªùi!",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "detect_emergency_type",
            "provide_safety_guidance"
          ],
          "expected_next_step": "location",
          "actual_next_step": null,
          "extractions": {
            "emergencyTypes": [
              "SECURITY"
            ]
          },
          "validation_passed": [
            "Should provide safety advice"
          ],
          "validation_failed": [
            "Should detect ['SECURITY']"
          ],
          "duration_ms": 3.713369369506836,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "68 Tr·∫ßn H∆∞ng ƒê·∫°o, Ph∆∞·ªùng 6, Qu·∫≠n Th·ªß ƒê·ª©c, TP.HCM",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": null,
          "extractions": {
            "location": {
              "full": "68 Tr·∫ßn H∆∞ng ƒê·∫°o, Ph∆∞·ªùng 6, Qu·∫≠n Th·ªß ƒê·ª©c, TP.HCM",
              "address": "68 Tr·∫ßn H∆∞ng ƒê·∫°o",
              "ward": "Ph∆∞·ªùng 6",
              "district": "Qu·∫≠n Th·ªß ƒê·ª©c",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 17.073631286621094,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0366546605",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": null,
          "extractions": {
            "phone": "0366546605"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 16.405344009399414,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "3 ng∆∞·ªùi",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": null,
          "extractions": {
            "affectedPeople": {
              "total": 3
            }
          },
          "validation_passed": [
            "Should extract count"
          ],
          "validation_failed": [],
          "duration_ms": 17.82965660095215,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "ƒê√∫ng, nhanh l√™n!",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": null,
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should dispatch police"
          ],
          "validation_failed": [
            "Should create ticket"
          ],
          "duration_ms": 17.052173614501953,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": false,
      "ticket_created": false,
      "ticket_id": null,
      "metrics": {
        "workflow_completion": 0.04608101592616112,
        "conversation_coherence": 0.10709807441183247,
        "state_transition": 0.0,
        "information_extraction": 0.06678540568969145,
        "correction_handling": 0.018442409638582145,
        "first_aid_guidance": 0.0195801115911675
      },
      "overall_passed": false,
      "total_duration_ms": 21930.456,
      "timestamp": "2026-01-04T03:18:29.913784",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ ng∆∞·ªùi say r∆∞·ª£u ƒëang ƒë·∫≠p ph√° qu√°n, ƒëe d·ªça m·ªçi ng∆∞·ªùi!"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "68 Tr·∫ßn H∆∞ng ƒê·∫°o, Ph∆∞·ªùng 6, Qu·∫≠n Th·ªß ƒê·ª©c, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "0366546605"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "3 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng, nhanh l√™n!"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        }
      ]
    },
    {
      "test_case_id": "MULTI_SEC_005",
      "name": "Security Emergency: T√¥i ph√°t hi·ªán c√≥ ng∆∞·ªùi ƒëang r√¨...",
      "category": "security_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "T√¥i ph√°t hi·ªán c√≥ ng∆∞·ªùi ƒëang r√¨nh r·∫≠p tr∆∞·ªõc nh√†, r·∫•t ƒë√°ng ng·ªù!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\nH√£y gi·ªØ b√¨nh tƒ©nh, di chuy·ªÉn ƒë·∫øn n∆°i an to√†n n·∫øu c√≥ th·ªÉ, v√† tr√°nh ƒë·ªëi ƒë·∫ßu tr·ª±c ti·∫øp.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "provide_safety_guidance"
          ],
          "expected_next_step": "location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "SECURITY"
            ]
          },
          "validation_passed": [
            "Should provide safety advice"
          ],
          "validation_failed": [
            "Should detect ['SECURITY']"
          ],
          "duration_ms": 1832.6795101165771,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "72 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 6, Huy·ªán B√¨nh Ch√°nh, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "72 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 6, Huy·ªán B√¨nh Ch√°nh, TP.HCM",
              "address": "72 C√°ch M·∫°ng Th√°ng 8",
              "ward": "Ph∆∞·ªùng 6",
              "district": "Huy·ªán B√¨nh Ch√°nh",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1706.5298557281494,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0987947061",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi c·∫ßn tr·ª£ gi√∫p?",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "people",
          "extractions": {
            "phone": "0987947061"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 914.1747951507568,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "1 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 72 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 6, Huy·ªán B√¨nh Ch√°nh, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** An ninh\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0987947061\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C√¥ng an\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 1
            }
          },
          "validation_passed": [
            "Should extract count"
          ],
          "validation_failed": [],
          "duration_ms": 885.0209712982178,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "ƒê√∫ng, nhanh l√™n!",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201903-KWMP ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 72 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 6, Huy·ªán B√¨nh Ch√°nh, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: An ninh\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0987947061\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C√¥ng an ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket",
            "Should dispatch police"
          ],
          "validation_failed": [],
          "duration_ms": 9550.558090209961,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-201903-KWMP",
      "metrics": {
        "workflow_completion": 0.7251043449219569,
        "conversation_coherence": 0.9798186782540317,
        "state_transition": 0.9970687768241685,
        "information_extraction": 0.8810106643101632,
        "correction_handling": 0.9851952803847783,
        "first_aid_guidance": 0.7871160332798892
      },
      "overall_passed": true,
      "total_duration_ms": 37916.656,
      "timestamp": "2026-01-04T03:18:51.844669",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "T√¥i ph√°t hi·ªán c√≥ ng∆∞·ªùi ƒëang r√¨nh r·∫≠p tr∆∞·ªõc nh√†, r·∫•t ƒë√°ng ng·ªù!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\nH√£y gi·ªØ b√¨nh tƒ©nh, di chuy·ªÉn ƒë·∫øn n∆°i an to√†n n·∫øu c√≥ th·ªÉ, v√† tr√°nh ƒë·ªëi ƒë·∫ßu tr·ª±c ti·∫øp.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "72 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 6, Huy·ªán B√¨nh Ch√°nh, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0987947061"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi c·∫ßn tr·ª£ gi√∫p?"
        },
        {
          "role": "user",
          "message": "1 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 72 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 6, Huy·ªán B√¨nh Ch√°nh, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** An ninh\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0987947061\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C√¥ng an\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng, nhanh l√™n!"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201903-KWMP ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 72 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 6, Huy·ªán B√¨nh Ch√°nh, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: An ninh\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0987947061\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C√¥ng an ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_SEC_006",
      "name": "Security Emergency: B·∫°o l·ª±c gia ƒë√¨nh! Ch·ªìng ƒëang ƒë...",
      "category": "security_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "B·∫°o l·ª±c gia ƒë√¨nh! Ch·ªìng ƒëang ƒë√°nh v·ª£, nghe ti·∫øng la h√©t!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\nH√£y gi·ªØ b√¨nh tƒ©nh, di chuy·ªÉn ƒë·∫øn n∆°i an to√†n n·∫øu c√≥ th·ªÉ, v√† tr√°nh ƒë·ªëi ƒë·∫ßu tr·ª±c ti·∫øp.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "provide_safety_guidance"
          ],
          "expected_next_step": "location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "SECURITY",
              "MEDICAL"
            ]
          },
          "validation_passed": [
            "Should provide safety advice"
          ],
          "validation_failed": [
            "Should detect ['SECURITY', 'MEDICAL']"
          ],
          "duration_ms": 2034.3623161315918,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "498 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 2, Qu·∫≠n 5, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "498 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 2, Qu·∫≠n 5, TP.HCM",
              "address": "498 L√Ω T·ª± Tr·ªçng",
              "ward": "Ph∆∞·ªùng 2",
              "district": "Qu·∫≠n 5",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1614.8483753204346,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0916689763",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi c·∫ßn tr·ª£ gi√∫p?",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "people",
          "extractions": {
            "phone": "0916689763"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 934.2670440673828,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "1 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 498 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 2, Qu·∫≠n 5, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** An ninh\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0916689763\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C√¥ng an\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 1
            }
          },
          "validation_passed": [
            "Should extract count"
          ],
          "validation_failed": [],
          "duration_ms": 1143.2006359100342,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "ƒê√∫ng, nhanh l√™n!",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201940-FY0I ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 498 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 2, Qu·∫≠n 5, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: An ninh\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0916689763\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C√¥ng an ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket",
            "Should dispatch police"
          ],
          "validation_failed": [],
          "duration_ms": 8251.51777267456,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-201940-FY0I",
      "metrics": {
        "workflow_completion": 0.5751361255272364,
        "conversation_coherence": 0.9622459338205511,
        "state_transition": 0.9851952803847782,
        "information_extraction": 0.632929154586196,
        "correction_handling": 0.9731058566911021,
        "first_aid_guidance": 0.7517389505967804
      },
      "overall_passed": false,
      "total_duration_ms": 37583.657,
      "timestamp": "2026-01-04T03:19:29.761842",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "B·∫°o l·ª±c gia ƒë√¨nh! Ch·ªìng ƒëang ƒë√°nh v·ª£, nghe ti·∫øng la h√©t!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\nH√£y gi·ªØ b√¨nh tƒ©nh, di chuy·ªÉn ƒë·∫øn n∆°i an to√†n n·∫øu c√≥ th·ªÉ, v√† tr√°nh ƒë·ªëi ƒë·∫ßu tr·ª±c ti·∫øp.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "498 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 2, Qu·∫≠n 5, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0916689763"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi c·∫ßn tr·ª£ gi√∫p?"
        },
        {
          "role": "user",
          "message": "1 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 498 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 2, Qu·∫≠n 5, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** An ninh\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0916689763\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 1 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C√¥ng an\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng, nhanh l√™n!"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-201940-FY0I ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 498 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 2, Qu·∫≠n 5, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: An ninh\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0916689763\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 1\n\nüö® **C√¥ng an ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_SEC_007",
      "name": "Security Emergency: C√≥ v·ª• c∆∞·ªõp ng√¢n h√†ng ƒëang x·∫£y ...",
      "category": "security_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ v·ª• c∆∞·ªõp ng√¢n h√†ng ƒëang x·∫£y ra!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\nH√£y gi·ªØ b√¨nh tƒ©nh, di chuy·ªÉn ƒë·∫øn n∆°i an to√†n n·∫øu c√≥ th·ªÉ, v√† tr√°nh ƒë·ªëi ƒë·∫ßu tr·ª±c ti·∫øp.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "provide_safety_guidance"
          ],
          "expected_next_step": "location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "SECURITY"
            ]
          },
          "validation_passed": [
            "Should provide safety advice"
          ],
          "validation_failed": [
            "Should detect ['SECURITY']"
          ],
          "duration_ms": 2619.3342208862305,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "7 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 10, Qu·∫≠n 2, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "7 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 10, Qu·∫≠n 2, TP.HCM",
              "address": "7 L√Ω T·ª± Tr·ªçng",
              "ward": "Ph∆∞·ªùng 10",
              "district": "Qu·∫≠n 2",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1892.8425312042236,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0348961223",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi c·∫ßn tr·ª£ gi√∫p?",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "people",
          "extractions": {
            "phone": "0348961223"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 2998.2783794403076,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "3 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 7 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 10, Qu·∫≠n 2, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** An ninh\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0348961223\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C√¥ng an\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 3
            }
          },
          "validation_passed": [
            "Should extract count"
          ],
          "validation_failed": [],
          "duration_ms": 1067.3246383666992,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "ƒê√∫ng, nhanh l√™n!",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202021-5N09 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 7 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 10, Qu·∫≠n 2, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: An ninh\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0348961223\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 3\n\nüö® **C√¥ng an ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket",
            "Should dispatch police"
          ],
          "validation_failed": [],
          "duration_ms": 8725.759029388428,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-202021-5N09",
      "metrics": {
        "workflow_completion": 0.837886146778381,
        "conversation_coherence": 0.95,
        "state_transition": 0.9962673112254283,
        "information_extraction": 0.9032257857792093,
        "correction_handling": 0.979818678013997,
        "first_aid_guidance": 0.7762904873529828
      },
      "overall_passed": true,
      "total_duration_ms": 38863.619999999995,
      "timestamp": "2026-01-04T03:20:07.345762",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ v·ª• c∆∞·ªõp ng√¢n h√†ng ƒëang x·∫£y ra!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\nH√£y gi·ªØ b√¨nh tƒ©nh, di chuy·ªÉn ƒë·∫øn n∆°i an to√†n n·∫øu c√≥ th·ªÉ, v√† tr√°nh ƒë·ªëi ƒë·∫ßu tr·ª±c ti·∫øp.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "7 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 10, Qu·∫≠n 2, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0348961223"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi c·∫ßn tr·ª£ gi√∫p?"
        },
        {
          "role": "user",
          "message": "3 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 7 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 10, Qu·∫≠n 2, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** An ninh\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0348961223\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C√¥ng an\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng, nhanh l√™n!"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202021-5N09 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 7 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 10, Qu·∫≠n 2, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: An ninh\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0348961223\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 3\n\nüö® **C√¥ng an ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_SEC_008",
      "name": "Security Emergency: Nh√≥m thanh ni√™n ƒëua xe, g√¢y r·ªë...",
      "category": "security_emergency_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "Nh√≥m thanh ni√™n ƒëua xe, g√¢y r·ªëi tr·∫≠t t·ª±!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\nH√£y gi·ªØ b√¨nh tƒ©nh, di chuy·ªÉn ƒë·∫øn n∆°i an to√†n n·∫øu c√≥ th·ªÉ, v√† tr√°nh ƒë·ªëi ƒë·∫ßu tr·ª±c ti·∫øp.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "provide_safety_guidance"
          ],
          "expected_next_step": "location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "SECURITY"
            ]
          },
          "validation_passed": [
            "Should provide safety advice"
          ],
          "validation_failed": [
            "Should detect ['SECURITY']"
          ],
          "duration_ms": 1827.599287033081,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "316 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 10, Qu·∫≠n Ph√∫ Nhu·∫≠n, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "316 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 10, Qu·∫≠n Ph√∫ Nhu·∫≠n, TP.HCM",
              "address": "316 L√Ω T·ª± Tr·ªçng",
              "ward": "Ph∆∞·ªùng 10",
              "district": "Qu·∫≠n Ph√∫ Nhu·∫≠n",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1533.508062362671,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0857258507",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi c·∫ßn tr·ª£ gi√∫p?",
          "expected_actions": [
            "validate_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "people",
          "extractions": {
            "phone": "0857258507"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 1062.7975463867188,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "2 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 316 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 10, Qu·∫≠n Ph√∫ Nhu·∫≠n, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** An ninh\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0857258507\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 2 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C√¥ng an\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 2
            }
          },
          "validation_passed": [
            "Should extract count"
          ],
          "validation_failed": [],
          "duration_ms": 924.5383739471436,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "ƒê√∫ng, nhanh l√™n!",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202058-7PIF ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 316 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 10, Qu·∫≠n Ph√∫ Nhu·∫≠n, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: An ninh\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0857258507\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 2\n\nüö® **C√¥ng an ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket",
            "Should dispatch police"
          ],
          "validation_failed": [],
          "duration_ms": 11944.23532485962,
          "errors": []
        }
      ],
      "total_turns": 5,
      "completed_turns": 5,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-202058-7PIF",
      "metrics": {
        "workflow_completion": 0.6703122048348241,
        "conversation_coherence": 0.9679178699175394,
        "state_transition": 0.9957912273886663,
        "information_extraction": 0.8944578102854457,
        "correction_handling": 0.9798186768138228,
        "first_aid_guidance": 0.7843938789048821
      },
      "overall_passed": true,
      "total_duration_ms": 46460.262,
      "timestamp": "2026-01-04T03:20:46.209690",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "Nh√≥m thanh ni√™n ƒëua xe, g√¢y r·ªëi tr·∫≠t t·ª±!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\nH√£y gi·ªØ b√¨nh tƒ©nh, di chuy·ªÉn ƒë·∫øn n∆°i an to√†n n·∫øu c√≥ th·ªÉ, v√† tr√°nh ƒë·ªëi ƒë·∫ßu tr·ª±c ti·∫øp.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "316 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 10, Qu·∫≠n Ph√∫ Nhu·∫≠n, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0857258507"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi c·∫ßn tr·ª£ gi√∫p?"
        },
        {
          "role": "user",
          "message": "2 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 316 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 10, Qu·∫≠n Ph√∫ Nhu·∫≠n, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** An ninh\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0857258507\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 2 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C√¥ng an\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng, nhanh l√™n!"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202058-7PIF ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 316 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 10, Qu·∫≠n Ph√∫ Nhu·∫≠n, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: An ninh\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0857258507\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 2\n\nüö® **C√¥ng an ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_CORR_001",
      "name": "User Corrects Address",
      "category": "user_correction_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ ch√°y nh√†!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. Di chuy·ªÉn b√¨nh ch·ªØa ch√°y ƒë·∫øn ƒë√°m ch√°y\n2. R√∫t ch·ªët b√¨nh ch·ªØa ch√°y\n3. B√≥p van b√¨nh ch·ªØa ch√°y\n4. L·∫Øc x√≥c b√¨nh b·ªôt tr∆∞·ªõc khi s·ª≠ d·ª•ng\n5. ƒê·ªÅ ph√≤ng nguy c∆° b·ªèng l·∫°nh khi s·ª≠ d·ª•ng b√¨nh kh√≠, g√¢y ho·∫°i t·ª≠ cho da\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "FIRE_RESCUE"
            ]
          },
          "validation_passed": [
            "Should detect fire"
          ],
          "validation_failed": [],
          "duration_ms": 4921.127557754517,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "129 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 4, Th√†nh ph·ªë Th·ªß ƒê·ª©c, TP.HCM",
          "bot_response": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "extract_location"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "location",
          "extractions": {
            "location": {
              "full": "129 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 4, Th√†nh ph·ªë Th·ªß ƒê·ª©c, TP.HCM",
              "address": "129 ƒêi·ªán Bi√™n Ph·ªß",
              "ward": "Ph∆∞·ªùng 4",
              "district": "Th√†nh ph·ªë Th·ªß ƒê·ª©c",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract first address"
          ],
          "validation_failed": [],
          "duration_ms": 2772.1991539001465,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0593394096",
          "bot_response": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "validate_phone"
          ],
          "expected_next_step": "people",
          "actual_next_step": "location",
          "extractions": {
            "phone": "0593394096"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 1034.0025424957275,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "2 ng∆∞·ªùi",
          "bot_response": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "location",
          "extractions": {
            "affectedPeople": {
              "total": 2
            }
          },
          "validation_passed": [],
          "validation_failed": [
            "Should show confirmation"
          ],
          "duration_ms": 1013.608455657959,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "Kh√¥ng, sai ƒë·ªãa ch·ªâ r·ªìi. ƒê·ªãa ch·ªâ ƒë√∫ng l√† 176 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 1, Qu·∫≠n 11, TP.HCM",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 176 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 1, Qu·∫≠n 11, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0593394096\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 2 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "detect_correction",
            "update_location",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "176 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 1, Qu·∫≠n 11, TP.HCM",
              "address": "176 Nguy·ªÖn Tr√£i",
              "ward": "Ph∆∞·ªùng 1",
              "district": "Qu·∫≠n 11",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            },
            "isCorrection": true
          },
          "validation_passed": [
            "Should detect correction",
            "Should update address",
            "Should show new confirmation"
          ],
          "validation_failed": [],
          "duration_ms": 1365.016222000122,
          "errors": []
        },
        {
          "turn_number": 6,
          "user_message": "ƒê√∫ng r·ªìi, x√°c nh·∫≠n",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202149-QLEL ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 176 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 1, Qu·∫≠n 11, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0593394096\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 2\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket with corrected address"
          ],
          "validation_failed": [],
          "duration_ms": 9381.127834320068,
          "errors": []
        }
      ],
      "total_turns": 6,
      "completed_turns": 6,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-202149-QLEL",
      "metrics": {
        "workflow_completion": 0.5552887412494738,
        "conversation_coherence": 0.6568374055247597,
        "state_transition": 0.8681643504853005,
        "information_extraction": 0.7798484581288441,
        "correction_handling": 0.9382589230415872,
        "first_aid_guidance": 0.7021604540974264
      },
      "overall_passed": false,
      "total_duration_ms": 43018.884,
      "timestamp": "2026-01-04T03:21:32.670288",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ ch√°y nh√†!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. Di chuy·ªÉn b√¨nh ch·ªØa ch√°y ƒë·∫øn ƒë√°m ch√°y\n2. R√∫t ch·ªët b√¨nh ch·ªØa ch√°y\n3. B√≥p van b√¨nh ch·ªØa ch√°y\n4. L·∫Øc x√≥c b√¨nh b·ªôt tr∆∞·ªõc khi s·ª≠ d·ª•ng\n5. ƒê·ªÅ ph√≤ng nguy c∆° b·ªèng l·∫°nh khi s·ª≠ d·ª•ng b√¨nh kh√≠, g√¢y ho·∫°i t·ª≠ cho da\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "129 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng 4, Th√†nh ph·ªë Th·ªß ƒê·ª©c, TP.HCM"
        },
        {
          "role": "bot",
          "message": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "0593394096"
        },
        {
          "role": "bot",
          "message": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "2 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "Kh√¥ng, sai ƒë·ªãa ch·ªâ r·ªìi. ƒê·ªãa ch·ªâ ƒë√∫ng l√† 176 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 1, Qu·∫≠n 11, TP.HCM"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 176 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 1, Qu·∫≠n 11, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0593394096\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 2 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng r·ªìi, x√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202149-QLEL ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 176 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 1, Qu·∫≠n 11, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0593394096\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 2\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_CORR_002",
      "name": "User Corrects Phone",
      "category": "user_correction_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "Tai n·∫°n giao th√¥ng!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o hi·ªán tr∆∞·ªùng an to√†n, lo·∫°i b·ªè nguy c∆° ch·∫≠p ƒëi·ªán, ch√°y n·ªï, xe c·ªô qua l·∫°i.\n2. Ki·ªÉm tra n·∫°n nh√¢n c√≤n t·ªânh hay b·∫•t t·ªânh b·∫±ng c√°ch lay g·ªçi ho·∫∑c k√≠ch th√≠ch ƒëau.\n3. Tr∆∞·ªùng h·ª£p nghi ng·ªù c√≥ ch·∫•n th∆∞∆°ng c·ªôt s·ªëng, kh√¥ng di chuy·ªÉn n·∫°n nh√¢n, ƒë·ªÉ n·∫°n nh√¢n n·∫±m b·∫•t ƒë·ªông t·∫°i ch·ªó.\n4. Tr·∫•n an n·∫°n nh√¢n, gi√∫p n·∫°n nh√¢n gi·ªØ b√¨nh tƒ©nh, h·∫°n ch·∫ø v·∫≠n ƒë·ªông v√πng kh·ªõp b·ªã tr·∫≠t n·∫øu c√≥.\n5. B·∫•t ƒë·ªông v√πng kh·ªõp b·ªã tr·∫≠t, gi·ªØ nguy√™n t∆∞ th·∫ø ƒë·∫øn khi h·ªó tr·ª£ y t·∫ø ƒë·∫øn.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "MEDICAL"
            ]
          },
          "validation_passed": [
            "Should detect medical"
          ],
          "validation_failed": [],
          "duration_ms": 7790.742635726929,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "459 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 3, Qu·∫≠n G√≤ V·∫•p, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "459 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 3, Qu·∫≠n G√≤ V·∫•p, TP.HCM",
              "address": "459 L√Ω T·ª± Tr·ªçng",
              "ward": "Ph∆∞·ªùng 3",
              "district": "Qu·∫≠n G√≤ V·∫•p",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1710.1593017578125,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0852841658",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã th∆∞∆°ng? C√≥ ai nguy k·ªãch kh√¥ng?",
          "expected_actions": [
            "validate_phone"
          ],
          "expected_next_step": "people",
          "actual_next_step": "people",
          "extractions": {
            "phone": "0852841658"
          },
          "validation_passed": [
            "Should validate first phone"
          ],
          "validation_failed": [],
          "duration_ms": 915.5838489532471,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "3 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 459 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 3, Qu·∫≠n G√≤ V·∫•p, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0852841658\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 3
            }
          },
          "validation_passed": [
            "Should show confirmation"
          ],
          "validation_failed": [],
          "duration_ms": 872.1153736114502,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "Xin l·ªói, s·ªë ƒëi·ªán tho·∫°i ƒë√∫ng l√† 0545172179",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 459 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 3, Qu·∫≠n G√≤ V·∫•p, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0545172179\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "detect_correction",
            "update_phone",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "phone": "0545172179",
            "isCorrection": true
          },
          "validation_passed": [
            "Should update phone",
            "Should show new confirmation"
          ],
          "validation_failed": [],
          "duration_ms": 1107.4919700622559,
          "errors": []
        },
        {
          "turn_number": 6,
          "user_message": "OK",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202233-WWS9 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 459 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 3, Qu·∫≠n G√≤ V·∫•p, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0545172179\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 3\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket with corrected phone"
          ],
          "validation_failed": [],
          "duration_ms": 8982.773065567017,
          "errors": []
        }
      ],
      "total_turns": 6,
      "completed_turns": 6,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-202233-WWS9",
      "metrics": {
        "workflow_completion": 0.8437731909506476,
        "conversation_coherence": 0.9651354864666054,
        "state_transition": 0.9979667648401132,
        "information_extraction": 0.783874260047104,
        "correction_handling": 1.0,
        "first_aid_guidance": 0.7495020638132756
      },
      "overall_passed": true,
      "total_duration_ms": 43703.039,
      "timestamp": "2026-01-04T03:22:15.689798",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "Tai n·∫°n giao th√¥ng!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o hi·ªán tr∆∞·ªùng an to√†n, lo·∫°i b·ªè nguy c∆° ch·∫≠p ƒëi·ªán, ch√°y n·ªï, xe c·ªô qua l·∫°i.\n2. Ki·ªÉm tra n·∫°n nh√¢n c√≤n t·ªânh hay b·∫•t t·ªânh b·∫±ng c√°ch lay g·ªçi ho·∫∑c k√≠ch th√≠ch ƒëau.\n3. Tr∆∞·ªùng h·ª£p nghi ng·ªù c√≥ ch·∫•n th∆∞∆°ng c·ªôt s·ªëng, kh√¥ng di chuy·ªÉn n·∫°n nh√¢n, ƒë·ªÉ n·∫°n nh√¢n n·∫±m b·∫•t ƒë·ªông t·∫°i ch·ªó.\n4. Tr·∫•n an n·∫°n nh√¢n, gi√∫p n·∫°n nh√¢n gi·ªØ b√¨nh tƒ©nh, h·∫°n ch·∫ø v·∫≠n ƒë·ªông v√πng kh·ªõp b·ªã tr·∫≠t n·∫øu c√≥.\n5. B·∫•t ƒë·ªông v√πng kh·ªõp b·ªã tr·∫≠t, gi·ªØ nguy√™n t∆∞ th·∫ø ƒë·∫øn khi h·ªó tr·ª£ y t·∫ø ƒë·∫øn.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "459 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 3, Qu·∫≠n G√≤ V·∫•p, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0852841658"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã th∆∞∆°ng? C√≥ ai nguy k·ªãch kh√¥ng?"
        },
        {
          "role": "user",
          "message": "3 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 459 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 3, Qu·∫≠n G√≤ V·∫•p, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0852841658\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "Xin l·ªói, s·ªë ƒëi·ªán tho·∫°i ƒë√∫ng l√† 0545172179"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 459 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 3, Qu·∫≠n G√≤ V·∫•p, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0545172179\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "OK"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202233-WWS9 ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 459 L√Ω T·ª± Tr·ªçng, Ph∆∞·ªùng 3, Qu·∫≠n G√≤ V·∫•p, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0545172179\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 3\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_CORR_003",
      "name": "User Corrects People Count",
      "category": "user_correction_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ ch√°y ·ªü nh√† h√†ng x√≥m!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† ng∆∞·ªùi xung quanh b·∫±ng c√°ch di chuy·ªÉn ra kh·ªèi khu v·ª±c nguy hi·ªÉm, nh∆∞ng kh√¥ng ch·∫°y v√†o khu v·ª±c c√≥ kh√≥i ƒë·∫∑c.\n2. N·∫øu c√≥ kh·∫£ nƒÉng, s·ª≠ d·ª•ng b√¨nh ch·ªØa ch√°y g·∫ßn nh·∫•t ƒë·ªÉ d·∫≠p l·ª≠a nh·ªè v√† ki·ªÉm so√°t t√¨nh h√¨nh:\n   - L·∫Øc x√≥c b√¨nh b·ªôt tr∆∞·ªõc khi s·ª≠ d·ª•ng.\n   - R√∫t ch·ªët an to√†n.\n   - B√≥p van v√† h∆∞·ªõng mi·ªáng phun v·ªÅ ph√≠a ƒë√°m ch√°y.\n3. ƒê√≥ng c·ª≠a c√°c ph√≤ng ƒë·ªÉ h·∫°n ch·∫ø s·ª± lan r·ªông c·ªßa kh√≥i v√† l·ª≠a.\n4. N·∫øu c√≥ kh√≥i ƒë·∫∑c, h√£y c√∫i th·∫•p ng∆∞·ªùi v√† di chuy·ªÉn b·∫±ng c√°ch b√≤ ƒë·ªÉ tr√°nh h√≠t ph·∫£i kh√≥i.\n5. B√°o ƒë·ªông cho nh·ªØng ng∆∞·ªùi xung quanh v√† h·ªó tr·ª£ nhau tho√°t ra ngo√†i an to√†n n·∫øu c√≥ th·ªÉ.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "FIRE_RESCUE"
            ]
          },
          "validation_passed": [
            "Should detect fire"
          ],
          "validation_failed": [],
          "duration_ms": 7841.574192047119,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "201 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán C·ªß Chi, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "201 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán C·ªß Chi, TP.HCM",
              "address": "201 C√°ch M·∫°ng Th√°ng 8",
              "ward": "Ph∆∞·ªùng 4",
              "district": "Huy·ªán C·ªß Chi",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1569.3931579589844,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0552433954",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?",
          "expected_actions": [
            "validate_phone"
          ],
          "expected_next_step": "people",
          "actual_next_step": "people",
          "extractions": {
            "phone": "0552433954"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 892.1232223510742,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "2 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 201 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán C·ªß Chi, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0552433954\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 2 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 2
            }
          },
          "validation_passed": [
            "Should show confirmation with 2 people"
          ],
          "validation_failed": [],
          "duration_ms": 920.6600189208984,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "Kh√¥ng, th·ª±c ra c√≥ 5 ng∆∞·ªùi, t√¥i ƒë·∫øm nh·∫ßm",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 201 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán C·ªß Chi, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0552433954\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 5 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "detect_correction",
            "update_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 5
            },
            "isCorrection": true
          },
          "validation_passed": [
            "Should update to 5 people",
            "Should show new confirmation"
          ],
          "validation_failed": [],
          "duration_ms": 905.0614833831787,
          "errors": []
        },
        {
          "turn_number": 6,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202316-INOE ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 201 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán C·ªß Chi, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0552433954\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 5\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket with 5 people"
          ],
          "validation_failed": [],
          "duration_ms": 8100.987434387207,
          "errors": []
        }
      ],
      "total_turns": 6,
      "completed_turns": 6,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-202316-INOE",
      "metrics": {
        "workflow_completion": 0.8109490631706912,
        "conversation_coherence": 0.9777299866333614,
        "state_transition": 1.0,
        "information_extraction": 0.8707994200363345,
        "correction_handling": 1.0,
        "first_aid_guidance": 0.8436736786473954
      },
      "overall_passed": true,
      "total_duration_ms": 40937.524000000005,
      "timestamp": "2026-01-04T03:22:59.393077",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ ch√°y ·ªü nh√† h√†ng x√≥m!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† ng∆∞·ªùi xung quanh b·∫±ng c√°ch di chuy·ªÉn ra kh·ªèi khu v·ª±c nguy hi·ªÉm, nh∆∞ng kh√¥ng ch·∫°y v√†o khu v·ª±c c√≥ kh√≥i ƒë·∫∑c.\n2. N·∫øu c√≥ kh·∫£ nƒÉng, s·ª≠ d·ª•ng b√¨nh ch·ªØa ch√°y g·∫ßn nh·∫•t ƒë·ªÉ d·∫≠p l·ª≠a nh·ªè v√† ki·ªÉm so√°t t√¨nh h√¨nh:\n   - L·∫Øc x√≥c b√¨nh b·ªôt tr∆∞·ªõc khi s·ª≠ d·ª•ng.\n   - R√∫t ch·ªët an to√†n.\n   - B√≥p van v√† h∆∞·ªõng mi·ªáng phun v·ªÅ ph√≠a ƒë√°m ch√°y.\n3. ƒê√≥ng c·ª≠a c√°c ph√≤ng ƒë·ªÉ h·∫°n ch·∫ø s·ª± lan r·ªông c·ªßa kh√≥i v√† l·ª≠a.\n4. N·∫øu c√≥ kh√≥i ƒë·∫∑c, h√£y c√∫i th·∫•p ng∆∞·ªùi v√† di chuy·ªÉn b·∫±ng c√°ch b√≤ ƒë·ªÉ tr√°nh h√≠t ph·∫£i kh√≥i.\n5. B√°o ƒë·ªông cho nh·ªØng ng∆∞·ªùi xung quanh v√† h·ªó tr·ª£ nhau tho√°t ra ngo√†i an to√†n n·∫øu c√≥ th·ªÉ.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "201 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán C·ªß Chi, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0552433954"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?"
        },
        {
          "role": "user",
          "message": "2 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 201 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán C·ªß Chi, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0552433954\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 2 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "Kh√¥ng, th·ª±c ra c√≥ 5 ng∆∞·ªùi, t√¥i ƒë·∫øm nh·∫ßm"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 201 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán C·ªß Chi, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0552433954\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 5 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202316-INOE ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 201 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Huy·ªán C·ªß Chi, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0552433954\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 5\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_CORR_004",
      "name": "Multiple Corrections",
      "category": "user_correction_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ v·ª• ƒë√°nh nhau!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\nH√£y gi·ªØ b√¨nh tƒ©nh, di chuy·ªÉn ƒë·∫øn n∆°i an to√†n n·∫øu c√≥ th·ªÉ, v√† tr√°nh ƒë·ªëi ƒë·∫ßu tr·ª±c ti·∫øp.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type"
          ],
          "expected_next_step": "location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "SECURITY"
            ]
          },
          "validation_passed": [],
          "validation_failed": [
            "Should detect security"
          ],
          "duration_ms": 862.8225326538086,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "138 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 10, Qu·∫≠n T√¢n Ph√∫, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "138 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 10, Qu·∫≠n T√¢n Ph√∫, TP.HCM",
              "address": "138 Hai B√† Tr∆∞ng",
              "ward": "Ph∆∞·ªùng 10",
              "district": "Qu·∫≠n T√¢n Ph√∫",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1446.2897777557373,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0354483047",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi c·∫ßn tr·ª£ gi√∫p?",
          "expected_actions": [
            "validate_phone"
          ],
          "expected_next_step": "people",
          "actual_next_step": "people",
          "extractions": {
            "phone": "0354483047"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 948.3094215393066,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "3 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 138 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 10, Qu·∫≠n T√¢n Ph√∫, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** An ninh\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0354483047\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C√¥ng an\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 3
            }
          },
          "validation_passed": [
            "Should show confirmation"
          ],
          "validation_failed": [],
          "duration_ms": 999.7003078460693,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "Sai h·∫øt r·ªìi! ƒê·ªãa ch·ªâ l√† 352 Nguy·ªÖn Hu·ªá, SƒêT l√† 0847426048",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 352 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 10, Qu·∫≠n T√¢n Ph√∫, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** An ninh\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0847426048\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C√¥ng an\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "detect_correction",
            "update_multiple_fields"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "address": "352 Nguy·ªÖn Hu·ªá"
            },
            "phone": "0847426048"
          },
          "validation_passed": [
            "Should update both fields"
          ],
          "validation_failed": [],
          "duration_ms": 1147.6330757141113,
          "errors": []
        },
        {
          "turn_number": 6,
          "user_message": "ƒê√∫ng r·ªìi",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202349-FPVL ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 352 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 10, Qu·∫≠n T√¢n Ph√∫, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: An ninh\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0847426048\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 3\n\nüö® **C√¥ng an ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket with corrected info"
          ],
          "validation_failed": [],
          "duration_ms": 5684.089183807373,
          "errors": []
        }
      ],
      "total_turns": 6,
      "completed_turns": 6,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-202349-FPVL",
      "metrics": {
        "workflow_completion": 0.7119659911776088,
        "conversation_coherence": 0.9468790626626244,
        "state_transition": 0.9939913344355842,
        "information_extraction": 0.8276552769688005,
        "correction_handling": 0.906622114579745,
        "first_aid_guidance": 0.3611419612438405
      },
      "overall_passed": false,
      "total_duration_ms": 34457.434,
      "timestamp": "2026-01-04T03:23:40.330721",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ v·ª• ƒë√°nh nhau!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\nH√£y gi·ªØ b√¨nh tƒ©nh, di chuy·ªÉn ƒë·∫øn n∆°i an to√†n n·∫øu c√≥ th·ªÉ, v√† tr√°nh ƒë·ªëi ƒë·∫ßu tr·ª±c ti·∫øp.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "138 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 10, Qu·∫≠n T√¢n Ph√∫, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0354483047"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi c·∫ßn tr·ª£ gi√∫p?"
        },
        {
          "role": "user",
          "message": "3 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 138 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 10, Qu·∫≠n T√¢n Ph√∫, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** An ninh\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0354483047\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C√¥ng an\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "Sai h·∫øt r·ªìi! ƒê·ªãa ch·ªâ l√† 352 Nguy·ªÖn Hu·ªá, SƒêT l√† 0847426048"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 352 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 10, Qu·∫≠n T√¢n Ph√∫, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** An ninh\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0847426048\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C√¥ng an\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng r·ªìi"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202349-FPVL ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 352 Nguy·ªÖn Hu·ªá, Ph∆∞·ªùng 10, Qu·∫≠n T√¢n Ph√∫, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: An ninh\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0847426048\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 3\n\nüö® **C√¥ng an ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_AUTH_001",
      "name": "Authenticated User Flow 1",
      "category": "authenticated_user_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "Ch√°y nh√† t√¥i!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. Di chuy·ªÉn b√¨nh ch·ªØa ch√°y ƒë·∫øn ƒë√°m ch√°y\n2. R√∫t ch·ªët an to√†n c·ªßa b√¨nh ch·ªØa ch√°y\n3. B√≥p van ƒë·ªÉ phun ch·∫•t ch·ªØa ch√°y v√†o ƒë√°m ch√°y\n4. N·∫øu s·ª≠ d·ª•ng b√¨nh b·ªôt, l·∫Øc x√≥c b√¨nh tr∆∞·ªõc khi s·ª≠ d·ª•ng\n5. ƒê·ªÅ ph√≤ng nguy c∆° b·ªèng l·∫°nh khi s·ª≠ d·ª•ng b√¨nh kh√≠, tr√°nh ti·∫øp x√∫c tr·ª±c ti·∫øp v·ªõi da\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "provide_guidance"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "FIRE_RESCUE"
            ]
          },
          "validation_passed": [
            "Should detect emergency type"
          ],
          "validation_failed": [],
          "duration_ms": 5124.67360496521,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "192 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 2, Qu·∫≠n 9, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location",
            "skip_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "192 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 2, Qu·∫≠n 9, TP.HCM",
              "address": "192 C√°ch M·∫°ng Th√°ng 8",
              "ward": "Ph∆∞·ªùng 2",
              "district": "Qu·∫≠n 9",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location",
            "Should ask for people count directly"
          ],
          "validation_failed": [
            "Should NOT ask for phone (user has saved phone)"
          ],
          "duration_ms": 1804.4347763061523,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "1 ng∆∞·ªùi",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 1
            }
          },
          "validation_passed": [
            "Confirmation should show saved phone number"
          ],
          "validation_failed": [
            "Should show confirmation"
          ],
          "duration_ms": 949.2206573486328,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Ticket should use saved phone"
          ],
          "validation_failed": [
            "Should create ticket"
          ],
          "duration_ms": 989.3250465393066,
          "errors": []
        }
      ],
      "total_turns": 4,
      "completed_turns": 4,
      "workflow_completed": false,
      "ticket_created": false,
      "ticket_id": null,
      "metrics": {
        "workflow_completion": 0.19677421414959317,
        "conversation_coherence": 0.3307552905901471,
        "state_transition": 0.23282557742901236,
        "information_extraction": 0.20293624565891397,
        "correction_handling": 0.2522311166807546,
        "first_aid_guidance": 0.4991333824464981
      },
      "overall_passed": false,
      "total_duration_ms": 29931.394,
      "timestamp": "2026-01-04T03:24:14.788408",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "Ch√°y nh√† t√¥i!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. Di chuy·ªÉn b√¨nh ch·ªØa ch√°y ƒë·∫øn ƒë√°m ch√°y\n2. R√∫t ch·ªët an to√†n c·ªßa b√¨nh ch·ªØa ch√°y\n3. B√≥p van ƒë·ªÉ phun ch·∫•t ch·ªØa ch√°y v√†o ƒë√°m ch√°y\n4. N·∫øu s·ª≠ d·ª•ng b√¨nh b·ªôt, l·∫Øc x√≥c b√¨nh tr∆∞·ªõc khi s·ª≠ d·ª•ng\n5. ƒê·ªÅ ph√≤ng nguy c∆° b·ªèng l·∫°nh khi s·ª≠ d·ª•ng b√¨nh kh√≠, tr√°nh ti·∫øp x√∫c tr·ª±c ti·∫øp v·ªõi da\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "192 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 2, Qu·∫≠n 9, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "1 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        }
      ]
    },
    {
      "test_case_id": "MULTI_AUTH_002",
      "name": "Authenticated User Flow 2",
      "category": "authenticated_user_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ tai n·∫°n giao th√¥ng!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o hi·ªán tr∆∞·ªùng an to√†n, lo·∫°i b·ªè nguy c∆° ch·∫≠p ƒëi·ªán, ch√°y n·ªï, xe c·ªô qua l·∫°i.\n2. Ki·ªÉm tra n·∫°n nh√¢n c√≤n t·ªânh hay b·∫•t t·ªânh b·∫±ng c√°ch lay g·ªçi ho·∫∑c k√≠ch th√≠ch ƒëau.\n3. Tr∆∞·ªùng h·ª£p nghi ng·ªù c√≥ ch·∫•n th∆∞∆°ng c·ªôt s·ªëng, kh√¥ng di chuy·ªÉn n·∫°n nh√¢n, ƒë·ªÉ n·∫°n nh√¢n n·∫±m b·∫•t ƒë·ªông t·∫°i ch·ªó.\n4. Tr·∫•n an n·∫°n nh√¢n, gi√∫p n·∫°n nh√¢n gi·ªØ b√¨nh tƒ©nh, h·∫°n ch·∫ø v·∫≠n ƒë·ªông v√πng kh·ªõp b·ªã tr·∫≠t n·∫øu c√≥.\n5. Gi·ªØ nguy√™n t∆∞ th·∫ø b·∫•t ƒë·ªông c·ªßa n·∫°n nh√¢n ƒë·∫øn khi h·ªó tr·ª£ y t·∫ø ƒë·∫øn.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "provide_guidance"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "MEDICAL"
            ]
          },
          "validation_passed": [
            "Should detect emergency type"
          ],
          "validation_failed": [],
          "duration_ms": 6739.030838012695,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "315 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 3, Huy·ªán H√≥c M√¥n, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location",
            "skip_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "315 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 3, Huy·ªán H√≥c M√¥n, TP.HCM",
              "address": "315 Hai B√† Tr∆∞ng",
              "ward": "Ph∆∞·ªùng 3",
              "district": "Huy·ªán H√≥c M√¥n",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location",
            "Should ask for people count directly"
          ],
          "validation_failed": [
            "Should NOT ask for phone (user has saved phone)"
          ],
          "duration_ms": 3604.163408279419,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "1 ng∆∞·ªùi",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 1
            }
          },
          "validation_passed": [
            "Confirmation should show saved phone number"
          ],
          "validation_failed": [
            "Should show confirmation"
          ],
          "duration_ms": 1094.0141677856445,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Ticket should use saved phone"
          ],
          "validation_failed": [
            "Should create ticket"
          ],
          "duration_ms": 1093.1692123413086,
          "errors": []
        }
      ],
      "total_turns": 4,
      "completed_turns": 4,
      "workflow_completed": false,
      "ticket_created": false,
      "ticket_id": null,
      "metrics": {
        "workflow_completion": 0.19537800331734229,
        "conversation_coherence": 0.31872251896095405,
        "state_transition": 0.209454233901008,
        "information_extraction": 0.2088617487081205,
        "correction_handling": 0.24542184130269926,
        "first_aid_guidance": 0.4811506634256035
      },
      "overall_passed": false,
      "total_duration_ms": 37740.433000000005,
      "timestamp": "2026-01-04T03:24:44.720151",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ tai n·∫°n giao th√¥ng!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o hi·ªán tr∆∞·ªùng an to√†n, lo·∫°i b·ªè nguy c∆° ch·∫≠p ƒëi·ªán, ch√°y n·ªï, xe c·ªô qua l·∫°i.\n2. Ki·ªÉm tra n·∫°n nh√¢n c√≤n t·ªânh hay b·∫•t t·ªânh b·∫±ng c√°ch lay g·ªçi ho·∫∑c k√≠ch th√≠ch ƒëau.\n3. Tr∆∞·ªùng h·ª£p nghi ng·ªù c√≥ ch·∫•n th∆∞∆°ng c·ªôt s·ªëng, kh√¥ng di chuy·ªÉn n·∫°n nh√¢n, ƒë·ªÉ n·∫°n nh√¢n n·∫±m b·∫•t ƒë·ªông t·∫°i ch·ªó.\n4. Tr·∫•n an n·∫°n nh√¢n, gi√∫p n·∫°n nh√¢n gi·ªØ b√¨nh tƒ©nh, h·∫°n ch·∫ø v·∫≠n ƒë·ªông v√πng kh·ªõp b·ªã tr·∫≠t n·∫øu c√≥.\n5. Gi·ªØ nguy√™n t∆∞ th·∫ø b·∫•t ƒë·ªông c·ªßa n·∫°n nh√¢n ƒë·∫øn khi h·ªó tr·ª£ y t·∫ø ƒë·∫øn.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "315 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 3, Huy·ªán H√≥c M√¥n, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "1 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        }
      ]
    },
    {
      "test_case_id": "MULTI_AUTH_003",
      "name": "Authenticated User Flow 3",
      "category": "authenticated_user_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ k·∫ª tr·ªôm!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\nH√£y gi·ªØ b√¨nh tƒ©nh, di chuy·ªÉn ƒë·∫øn n∆°i an to√†n n·∫øu c√≥ th·ªÉ, v√† tr√°nh ƒë·ªëi ƒë·∫ßu tr·ª±c ti·∫øp.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "provide_guidance"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "SECURITY"
            ]
          },
          "validation_passed": [],
          "validation_failed": [
            "Should detect emergency type"
          ],
          "duration_ms": 1184.85689163208,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "408 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 10, Qu·∫≠n 4, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location",
            "skip_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "408 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 10, Qu·∫≠n 4, TP.HCM",
              "address": "408 C√°ch M·∫°ng Th√°ng 8",
              "ward": "Ph∆∞·ªùng 10",
              "district": "Qu·∫≠n 4",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location",
            "Should ask for people count directly"
          ],
          "validation_failed": [
            "Should NOT ask for phone (user has saved phone)"
          ],
          "duration_ms": 1660.9985828399658,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "1 ng∆∞·ªùi",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 1
            }
          },
          "validation_passed": [
            "Confirmation should show saved phone number"
          ],
          "validation_failed": [
            "Should show confirmation"
          ],
          "duration_ms": 1030.2774906158447,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Ticket should use saved phone"
          ],
          "validation_failed": [
            "Should create ticket"
          ],
          "duration_ms": 1003.0763149261475,
          "errors": []
        }
      ],
      "total_turns": 4,
      "completed_turns": 4,
      "workflow_completed": false,
      "ticket_created": false,
      "ticket_id": null,
      "metrics": {
        "workflow_completion": 0.18933709065954732,
        "conversation_coherence": 0.288116698643813,
        "state_transition": 0.12414713960967741,
        "information_extraction": 0.2088617485093287,
        "correction_handling": 0.24439648671519576,
        "first_aid_guidance": 0.33965291585239765
      },
      "overall_passed": false,
      "total_duration_ms": 25848.912,
      "timestamp": "2026-01-04T03:25:22.460780",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ k·∫ª tr·ªôm!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\nH√£y gi·ªØ b√¨nh tƒ©nh, di chuy·ªÉn ƒë·∫øn n∆°i an to√†n n·∫øu c√≥ th·ªÉ, v√† tr√°nh ƒë·ªëi ƒë·∫ßu tr·ª±c ti·∫øp.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "408 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 10, Qu·∫≠n 4, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "1 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        }
      ]
    },
    {
      "test_case_id": "MULTI_AUTH_004",
      "name": "Authenticated User Flow 4",
      "category": "authenticated_user_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "Ng∆∞·ªùi nh√† b·ªã ƒë·ªôt qu·ªµ!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. Nh·∫≠n bi·∫øt s·ªõm c√°c d·∫•u hi·ªáu c·ªßa ƒë·ªôt qu·ªµ b·∫±ng c√°ch s·ª≠ d·ª•ng quy t·∫Øc BE FAST: B (Balance - m·∫•t thƒÉng b·∫±ng), E (Eyes - m·∫•t th·ªã l·ª±c ƒë·ªôt ng·ªôt), F (Face - m·∫∑t m√©o m√≥), A (Arms - tay y·∫øu ho·∫∑c kh√¥ng th·ªÉ n√¢ng cao), S (Speech - n√≥i kh√≥ ho·∫∑c kh√¥ng r√µ), T (Time - th·ªùi gian quan tr·ªçng, c·∫ßn h√†nh ƒë·ªông nhanh ch√≥ng).\n2. ƒê·∫£m b·∫£o an to√†n cho ng∆∞·ªùi b·ªánh, kh√¥ng di chuy·ªÉn h·ªç tr·ª´ khi c·∫ßn thi·∫øt ƒë·ªÉ tr√°nh l√†m t·ªïn th∆∞∆°ng th√™m.\n3. N·∫øu ng∆∞·ªùi b·ªánh √Ω th·ª©c ƒë∆∞·ª£c, ƒë·∫∑t h·ªç n·∫±m nghi√™ng ƒë·ªÉ gi·ªØ ƒë∆∞·ªùng th·ªü th√¥ng tho√°ng v√† tr√°nh nguy c∆° h√≠t ph·∫£i n∆∞·ªõc b·ªçt ho·∫∑c n√¥n m·ª≠a.\n4. Theo d√µi ch·∫∑t ch·∫Ω t√¨nh tr·∫°ng c·ªßa ng∆∞·ªùi b·ªánh, ghi nh·ªõ m·ªçi thay ƒë·ªïi v·ªÅ tri·ªáu ch·ª©ng ho·∫∑c t√¨nh tr·∫°ng s·ª©c kh·ªèe ƒë·ªÉ th√¥ng b√°o cho nh√¢n vi√™n y t·∫ø khi h·ªç ƒë·∫øn.\n5. Gi·ªØ b√¨nh tƒ©nh v√† ƒë·ªông vi√™n ng∆∞·ªùi b·ªánh, tr√°nh l√†m h·ªç ho·∫£ng s·ª£ ho·∫∑c cƒÉng th·∫≥ng th√™m.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "provide_guidance"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "MEDICAL"
            ]
          },
          "validation_passed": [
            "Should detect emergency type"
          ],
          "validation_failed": [],
          "duration_ms": 9458.268880844116,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "321 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 10, Qu·∫≠n 11, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location",
            "skip_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "321 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 10, Qu·∫≠n 11, TP.HCM",
              "address": "321 C√°ch M·∫°ng Th√°ng 8",
              "ward": "Ph∆∞·ªùng 10",
              "district": "Qu·∫≠n 11",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location",
            "Should ask for people count directly"
          ],
          "validation_failed": [
            "Should NOT ask for phone (user has saved phone)"
          ],
          "duration_ms": 1606.736660003662,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "3 ng∆∞·ªùi",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 3
            }
          },
          "validation_passed": [
            "Confirmation should show saved phone number"
          ],
          "validation_failed": [
            "Should show confirmation"
          ],
          "duration_ms": 965.0983810424805,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Ticket should use saved phone"
          ],
          "validation_failed": [
            "Should create ticket"
          ],
          "duration_ms": 1018.4135437011719,
          "errors": []
        }
      ],
      "total_turns": 4,
      "completed_turns": 4,
      "workflow_completed": false,
      "ticket_created": false,
      "ticket_id": null,
      "metrics": {
        "workflow_completion": 0.1829033237104445,
        "conversation_coherence": 0.2939478390942536,
        "state_transition": 0.22832869102142456,
        "information_extraction": 0.21402592384366645,
        "correction_handling": 0.24160388498547292,
        "first_aid_guidance": 0.7227778035677834
      },
      "overall_passed": false,
      "total_duration_ms": 37903.616,
      "timestamp": "2026-01-04T03:25:48.310015",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "Ng∆∞·ªùi nh√† b·ªã ƒë·ªôt qu·ªµ!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. Nh·∫≠n bi·∫øt s·ªõm c√°c d·∫•u hi·ªáu c·ªßa ƒë·ªôt qu·ªµ b·∫±ng c√°ch s·ª≠ d·ª•ng quy t·∫Øc BE FAST: B (Balance - m·∫•t thƒÉng b·∫±ng), E (Eyes - m·∫•t th·ªã l·ª±c ƒë·ªôt ng·ªôt), F (Face - m·∫∑t m√©o m√≥), A (Arms - tay y·∫øu ho·∫∑c kh√¥ng th·ªÉ n√¢ng cao), S (Speech - n√≥i kh√≥ ho·∫∑c kh√¥ng r√µ), T (Time - th·ªùi gian quan tr·ªçng, c·∫ßn h√†nh ƒë·ªông nhanh ch√≥ng).\n2. ƒê·∫£m b·∫£o an to√†n cho ng∆∞·ªùi b·ªánh, kh√¥ng di chuy·ªÉn h·ªç tr·ª´ khi c·∫ßn thi·∫øt ƒë·ªÉ tr√°nh l√†m t·ªïn th∆∞∆°ng th√™m.\n3. N·∫øu ng∆∞·ªùi b·ªánh √Ω th·ª©c ƒë∆∞·ª£c, ƒë·∫∑t h·ªç n·∫±m nghi√™ng ƒë·ªÉ gi·ªØ ƒë∆∞·ªùng th·ªü th√¥ng tho√°ng v√† tr√°nh nguy c∆° h√≠t ph·∫£i n∆∞·ªõc b·ªçt ho·∫∑c n√¥n m·ª≠a.\n4. Theo d√µi ch·∫∑t ch·∫Ω t√¨nh tr·∫°ng c·ªßa ng∆∞·ªùi b·ªánh, ghi nh·ªõ m·ªçi thay ƒë·ªïi v·ªÅ tri·ªáu ch·ª©ng ho·∫∑c t√¨nh tr·∫°ng s·ª©c kh·ªèe ƒë·ªÉ th√¥ng b√°o cho nh√¢n vi√™n y t·∫ø khi h·ªç ƒë·∫øn.\n5. Gi·ªØ b√¨nh tƒ©nh v√† ƒë·ªông vi√™n ng∆∞·ªùi b·ªánh, tr√°nh l√†m h·ªç ho·∫£ng s·ª£ ho·∫∑c cƒÉng th·∫≥ng th√™m.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "321 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 10, Qu·∫≠n 11, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "3 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        }
      ]
    },
    {
      "test_case_id": "MULTI_AUTH_005",
      "name": "Authenticated User Flow 5",
      "category": "authenticated_user_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ v·ª• ƒë√°nh nhau!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\nH√£y gi·ªØ b√¨nh tƒ©nh, di chuy·ªÉn ƒë·∫øn n∆°i an to√†n n·∫øu c√≥ th·ªÉ, v√† tr√°nh ƒë·ªëi ƒë·∫ßu tr·ª±c ti·∫øp.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "provide_guidance"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "SECURITY",
              "MEDICAL"
            ]
          },
          "validation_passed": [],
          "validation_failed": [
            "Should detect emergency type"
          ],
          "duration_ms": 880.8298110961914,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "141 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 12, Th√†nh ph·ªë Th·ªß ƒê·ª©c, TP.HCM",
          "bot_response": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "extract_location",
            "skip_phone",
            "ask_people"
          ],
          "expected_next_step": "people",
          "actual_next_step": "location",
          "extractions": {
            "location": {
              "full": "141 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 12, Th√†nh ph·ªë Th·ªß ƒê·ª©c, TP.HCM",
              "address": "141 Hai B√† Tr∆∞ng",
              "ward": "Ph∆∞·ªùng 12",
              "district": "Th√†nh ph·ªë Th·ªß ƒê·ª©c",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location",
            "Should NOT ask for phone (user has saved phone)",
            "Should ask for people count directly"
          ],
          "validation_failed": [],
          "duration_ms": 2335.188627243042,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "1 ng∆∞·ªùi",
          "bot_response": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "extract_people_count",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "location",
          "extractions": {
            "affectedPeople": {
              "total": 1
            }
          },
          "validation_passed": [
            "Confirmation should show saved phone number"
          ],
          "validation_failed": [
            "Should show confirmation"
          ],
          "duration_ms": 828.9182186126709,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "location",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Ticket should use saved phone"
          ],
          "validation_failed": [
            "Should create ticket"
          ],
          "duration_ms": 973.3374118804932,
          "errors": []
        }
      ],
      "total_turns": 4,
      "completed_turns": 4,
      "workflow_completed": false,
      "ticket_created": false,
      "ticket_id": null,
      "metrics": {
        "workflow_completion": 0.15708114018276242,
        "conversation_coherence": 0.18441206968099447,
        "state_transition": 0.06591586184747329,
        "information_extraction": 0.1648033532014352,
        "correction_handling": 0.18763052636426686,
        "first_aid_guidance": 0.25394330710032104
      },
      "overall_passed": false,
      "total_duration_ms": 25328.979,
      "timestamp": "2026-01-04T03:26:26.213908",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ v·ª• ƒë√°nh nhau!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\nH√£y gi·ªØ b√¨nh tƒ©nh, di chuy·ªÉn ƒë·∫øn n∆°i an to√†n n·∫øu c√≥ th·ªÉ, v√† tr√°nh ƒë·ªëi ƒë·∫ßu tr·ª±c ti·∫øp.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "141 Hai B√† Tr∆∞ng, Ph∆∞·ªùng 12, Th√†nh ph·ªë Th·ªß ƒê·ª©c, TP.HCM"
        },
        {
          "role": "bot",
          "message": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "1 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "B·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        }
      ]
    },
    {
      "test_case_id": "MULTI_EDGE_001",
      "name": "All Info in First Message",
      "category": "edge_case_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ ch√°y nh√† ·ªü 435 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 13, Qu·∫≠n 10, TP.HCM! S·ªë t√¥i l√† 0792170183, c√≥ 3 ng∆∞·ªùi trong nh√†!",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 435 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 13, Qu·∫≠n 10, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0792170183\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_all_info",
            "show_confirmation"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "emergencyTypes": [
              "FIRE_RESCUE"
            ],
            "location": {
              "full": "435 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 13, Qu·∫≠n 10, TP.HCM",
              "address": "435 Nguy·ªÖn Tr√£i",
              "ward": "Ph∆∞·ªùng 13",
              "district": "Qu·∫≠n 10",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            },
            "phone": "0792170183",
            "affectedPeople": {
              "total": 3
            }
          },
          "validation_passed": [
            "Should extract all info from single message",
            "Should go directly to confirmation"
          ],
          "validation_failed": [],
          "duration_ms": 1988.725185394287,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "ƒê√∫ng",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202656-8GTA ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 435 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 13, Qu·∫≠n 10, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0792170183\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 3\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket immediately"
          ],
          "validation_failed": [],
          "duration_ms": 7639.851093292236,
          "errors": []
        }
      ],
      "total_turns": 2,
      "completed_turns": 2,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-202656-8GTA",
      "metrics": {
        "workflow_completion": 0.44212268854895714,
        "conversation_coherence": 0.8957979671738314,
        "state_transition": 0.9939913344776621,
        "information_extraction": 0.6862043242511244,
        "correction_handling": 0.9816380330315214,
        "first_aid_guidance": 0.364138065773099
      },
      "overall_passed": false,
      "total_duration_ms": 31174.357,
      "timestamp": "2026-01-04T03:26:51.543137",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ ch√°y nh√† ·ªü 435 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 13, Qu·∫≠n 10, TP.HCM! S·ªë t√¥i l√† 0792170183, c√≥ 3 ng∆∞·ªùi trong nh√†!"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 435 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 13, Qu·∫≠n 10, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0792170183\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 3 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202656-8GTA ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 435 Nguy·ªÖn Tr√£i, Ph∆∞·ªùng 13, Qu·∫≠n 10, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0792170183\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 3\n\nüö® **C·ª©u h·ªèa ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_EDGE_002",
      "name": "Minimal User Responses",
      "category": "edge_case_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "Ch√°y",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† ng∆∞·ªùi xung quanh b·∫±ng c√°ch di chuy·ªÉn ra kh·ªèi khu v·ª±c nguy hi·ªÉm n·∫øu c√≥ th·ªÉ.\n2. C·ªë g·∫Øng d·∫≠p t·∫Øt ƒë√°m ch√°y b·∫±ng ph∆∞∆°ng ti·ªán ch·ªØa ch√°y t·∫°i ch·ªó n·∫øu ƒë√°m ch√°y c√≤n nh·ªè v√† c√≥ th·ªÉ ki·ªÉm so√°t ƒë∆∞·ª£c.\n3. ƒê√≥ng c·ª≠a ƒë·ªÉ h·∫°n ch·∫ø ƒë√°m ch√°y lan r·ªông nh∆∞ng kh√¥ng kh√≥a c·ª≠a, gi·ªØ l·ªëi tho√°t hi·ªÉm r√µ r√†ng.\n4. N·∫øu c√≥ kh√≥i, h√£y c√∫i th·∫•p ng∆∞·ªùi v√† di chuy·ªÉn b·∫±ng c√°ch b√≤ ƒë·ªÉ tr√°nh h√≠t ph·∫£i kh√≥i ƒë·ªôc.\n5. S·ª≠ d·ª•ng khƒÉn ∆∞·ªõt che m·∫∑t n·∫øu c·∫ßn thi·∫øt ƒë·ªÉ tr√°nh h√≠t ph·∫£i kh√≥i.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type",
            "ask_details"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "FIRE_RESCUE"
            ]
          },
          "validation_passed": [
            "Should understand minimal input"
          ],
          "validation_failed": [],
          "duration_ms": 8376.117706298828,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "186 Nguy·ªÖn Tr√£i",
          "bot_response": "ƒê·ªãa ch·ªâ \"186 Nguy·ªÖn Tr√£i\" thu·ªôc ph∆∞·ªùng/x√£ n√†o, t·ªânh/th√†nh ph·ªë n√†o?",
          "expected_actions": [
            "extract_partial_location",
            "ask_more"
          ],
          "expected_next_step": "location_clarification",
          "actual_next_step": "location",
          "extractions": {
            "location": {
              "address": "186 Nguy·ªÖn Tr√£i"
            }
          },
          "validation_passed": [
            "Should ask for more location details"
          ],
          "validation_failed": [],
          "duration_ms": 1212.8551006317139,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "Ph∆∞·ªùng 3, Qu·∫≠n 9",
          "bot_response": "T·ªânh ho·∫∑c th√†nh ph·ªë n√†o?",
          "expected_actions": [
            "complete_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": null,
          "extractions": {
            "location": {
              "ward": "Ph∆∞·ªùng 3"
            }
          },
          "validation_passed": [
            "Should complete location"
          ],
          "validation_failed": [],
          "duration_ms": 1222.3193645477295,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "0385395893",
          "bot_response": "T·ªânh ho·∫∑c th√†nh ph·ªë n√†o?",
          "expected_actions": [
            "validate_phone"
          ],
          "expected_next_step": "people",
          "actual_next_step": null,
          "extractions": {
            "phone": "0385395893"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 1001.4173984527588,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "1",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?",
          "expected_actions": [
            "extract_people_count"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "people",
          "extractions": {
            "affectedPeople": {
              "total": 1
            }
          },
          "validation_passed": [
            "Should understand '1' as people count"
          ],
          "validation_failed": [],
          "duration_ms": 1495.7506656646729,
          "errors": []
        },
        {
          "turn_number": 6,
          "user_message": "ok",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "people",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should understand 'ok' as confirmation"
          ],
          "validation_failed": [],
          "duration_ms": 845.008134841919,
          "errors": []
        }
      ],
      "total_turns": 6,
      "completed_turns": 6,
      "workflow_completed": false,
      "ticket_created": false,
      "ticket_id": null,
      "metrics": {
        "workflow_completion": 0.20420203282616853,
        "conversation_coherence": 0.30046322090031097,
        "state_transition": 0.44953465563099143,
        "information_extraction": 0.20534522760525262,
        "correction_handling": 0.2568978232620188,
        "first_aid_guidance": 0.5695696549385153
      },
      "overall_passed": false,
      "total_duration_ms": 37145.068,
      "timestamp": "2026-01-04T03:27:22.717869",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "Ch√°y"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho b·∫£n th√¢n v√† ng∆∞·ªùi xung quanh b·∫±ng c√°ch di chuy·ªÉn ra kh·ªèi khu v·ª±c nguy hi·ªÉm n·∫øu c√≥ th·ªÉ.\n2. C·ªë g·∫Øng d·∫≠p t·∫Øt ƒë√°m ch√°y b·∫±ng ph∆∞∆°ng ti·ªán ch·ªØa ch√°y t·∫°i ch·ªó n·∫øu ƒë√°m ch√°y c√≤n nh·ªè v√† c√≥ th·ªÉ ki·ªÉm so√°t ƒë∆∞·ª£c.\n3. ƒê√≥ng c·ª≠a ƒë·ªÉ h·∫°n ch·∫ø ƒë√°m ch√°y lan r·ªông nh∆∞ng kh√¥ng kh√≥a c·ª≠a, gi·ªØ l·ªëi tho√°t hi·ªÉm r√µ r√†ng.\n4. N·∫øu c√≥ kh√≥i, h√£y c√∫i th·∫•p ng∆∞·ªùi v√† di chuy·ªÉn b·∫±ng c√°ch b√≤ ƒë·ªÉ tr√°nh h√≠t ph·∫£i kh√≥i ƒë·ªôc.\n5. S·ª≠ d·ª•ng khƒÉn ∆∞·ªõt che m·∫∑t n·∫øu c·∫ßn thi·∫øt ƒë·ªÉ tr√°nh h√≠t ph·∫£i kh√≥i.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "186 Nguy·ªÖn Tr√£i"
        },
        {
          "role": "bot",
          "message": "ƒê·ªãa ch·ªâ \"186 Nguy·ªÖn Tr√£i\" thu·ªôc ph∆∞·ªùng/x√£ n√†o, t·ªânh/th√†nh ph·ªë n√†o?"
        },
        {
          "role": "user",
          "message": "Ph∆∞·ªùng 3, Qu·∫≠n 9"
        },
        {
          "role": "bot",
          "message": "T·ªânh ho·∫∑c th√†nh ph·ªë n√†o?"
        },
        {
          "role": "user",
          "message": "0385395893"
        },
        {
          "role": "bot",
          "message": "T·ªânh ho·∫∑c th√†nh ph·ªë n√†o?"
        },
        {
          "role": "user",
          "message": "1"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?"
        },
        {
          "role": "user",
          "message": "ok"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?"
        }
      ]
    },
    {
      "test_case_id": "MULTI_EDGE_003",
      "name": "Invalid Phone Then Valid",
      "category": "edge_case_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ tai n·∫°n!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho ch√≠nh b·∫°n: Ki·ªÉm tra hi·ªán tr∆∞·ªùng xem c√≥ an to√†n kh√¥ng, lo·∫°i b·ªè nguy c∆° ch·∫≠p ƒëi·ªán, ch√°y n·ªï, xe c·ªô qua l·∫°i.\n2. Ki·ªÉm tra ƒë√°p ·ª©ng c·ªßa n·∫°n nh√¢n: Lay g·ªçi n·∫°n nh√¢n b·∫±ng c√°ch h·ªèi \"B·∫°n c√≥ ·ªïn kh√¥ng?\" ho·∫∑c k√≠ch th√≠ch ƒëau nh·∫π.\n3. Kh√¥ng l√†m t√¨nh h√¨nh tr·ªü n√™n t·ªá h∆°n cho n·∫°n nh√¢n: Kh√¥ng di chuy·ªÉn n·∫°n nh√¢n n·∫øu nghi ng·ªù ch·∫•n th∆∞∆°ng c·ªôt s·ªëng, kh√¥ng cho b·∫•t k·ª≥ v·∫≠t l·∫°, ch·∫•t l·ªèng v√†o mi·ªáng n·∫°n nh√¢n.\n4. N·∫øu n·∫°n nh√¢n b·ªã tr·∫≠t kh·ªõp: Tr·∫•n an n·∫°n nh√¢n, gi·ªØ b√¨nh tƒ©nh v√† h·∫°n ch·∫ø v·∫≠n ƒë·ªông v√πng kh·ªõp b·ªã tr·∫≠t. Gi·ªØ nguy√™n t∆∞ th·∫ø b·∫•t ƒë·ªông.\n5. Ghi nh·∫≠n l·∫°i t√¨nh tr·∫°ng n·∫°n nh√¢n v√† c√°c bi·ªán ph√°p ƒë√£ th·ª±c hi·ªán ƒë·ªÉ cung c·∫•p cho nh√¢n vi√™n y t·∫ø khi h·ªç ƒë·∫øn.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "MEDICAL"
            ]
          },
          "validation_passed": [
            "Should detect medical"
          ],
          "validation_failed": [],
          "duration_ms": 10373.231172561646,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "304 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 13, Qu·∫≠n 5, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "304 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 13, Qu·∫≠n 5, TP.HCM",
              "address": "304 C√°ch M·∫°ng Th√°ng 8",
              "ward": "Ph∆∞·ªùng 13",
              "district": "Qu·∫≠n 5",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1668.0810451507568,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0123456789",
          "bot_response": "‚ùå S·ªë ƒëi·ªán tho·∫°i ch∆∞a ƒë√∫ng ƒë·ªãnh d·∫°ng. Vui l√≤ng cung c·∫•p l·∫°i s·ªë ƒëi·ªán tho·∫°i h·ª£p l·ªá (10 ch·ªØ s·ªë b·∫Øt ƒë·∫ßu b·∫±ng 09, 03, 07, 08, 05 ho·∫∑c ƒë·ªãnh d·∫°ng +84). V√≠ d·ª•: 0912345678 ho·∫∑c +84912345678.",
          "expected_actions": [
            "reject_phone",
            "ask_again"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "phoneValid": false
          },
          "validation_passed": [
            "Should reject invalid phone",
            "Should explain why invalid",
            "Should ask for valid phone"
          ],
          "validation_failed": [],
          "duration_ms": 885.6675624847412,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "0524774481",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã th∆∞∆°ng? C√≥ ai nguy k·ªãch kh√¥ng?",
          "expected_actions": [
            "validate_phone"
          ],
          "expected_next_step": "people",
          "actual_next_step": "people",
          "extractions": {
            "phone": "0524774481",
            "phoneValid": true
          },
          "validation_passed": [
            "Should accept valid phone"
          ],
          "validation_failed": [],
          "duration_ms": 1382.9140663146973,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "2 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 304 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 13, Qu·∫≠n 5, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0524774481\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 2 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 2
            }
          },
          "validation_passed": [
            "Should extract count"
          ],
          "validation_failed": [],
          "duration_ms": 947.5781917572021,
          "errors": []
        },
        {
          "turn_number": 6,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202820-97QG ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 304 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 13, Qu·∫≠n 5, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0524774481\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 2\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket"
          ],
          "validation_failed": [],
          "duration_ms": 8152.79746055603,
          "errors": []
        }
      ],
      "total_turns": 6,
      "completed_turns": 6,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-202820-97QG",
      "metrics": {
        "workflow_completion": 0.6829981599036758,
        "conversation_coherence": 0.9562176500885797,
        "state_transition": 0.996691401946611,
        "information_extraction": 0.6366740419190775,
        "correction_handling": 0.9851952796329895,
        "first_aid_guidance": 0.7434437305412993
      },
      "overall_passed": true,
      "total_duration_ms": 46967.104,
      "timestamp": "2026-01-04T03:27:59.863263",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ tai n·∫°n!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. ƒê·∫£m b·∫£o an to√†n cho ch√≠nh b·∫°n: Ki·ªÉm tra hi·ªán tr∆∞·ªùng xem c√≥ an to√†n kh√¥ng, lo·∫°i b·ªè nguy c∆° ch·∫≠p ƒëi·ªán, ch√°y n·ªï, xe c·ªô qua l·∫°i.\n2. Ki·ªÉm tra ƒë√°p ·ª©ng c·ªßa n·∫°n nh√¢n: Lay g·ªçi n·∫°n nh√¢n b·∫±ng c√°ch h·ªèi \"B·∫°n c√≥ ·ªïn kh√¥ng?\" ho·∫∑c k√≠ch th√≠ch ƒëau nh·∫π.\n3. Kh√¥ng l√†m t√¨nh h√¨nh tr·ªü n√™n t·ªá h∆°n cho n·∫°n nh√¢n: Kh√¥ng di chuy·ªÉn n·∫°n nh√¢n n·∫øu nghi ng·ªù ch·∫•n th∆∞∆°ng c·ªôt s·ªëng, kh√¥ng cho b·∫•t k·ª≥ v·∫≠t l·∫°, ch·∫•t l·ªèng v√†o mi·ªáng n·∫°n nh√¢n.\n4. N·∫øu n·∫°n nh√¢n b·ªã tr·∫≠t kh·ªõp: Tr·∫•n an n·∫°n nh√¢n, gi·ªØ b√¨nh tƒ©nh v√† h·∫°n ch·∫ø v·∫≠n ƒë·ªông v√πng kh·ªõp b·ªã tr·∫≠t. Gi·ªØ nguy√™n t∆∞ th·∫ø b·∫•t ƒë·ªông.\n5. Ghi nh·∫≠n l·∫°i t√¨nh tr·∫°ng n·∫°n nh√¢n v√† c√°c bi·ªán ph√°p ƒë√£ th·ª±c hi·ªán ƒë·ªÉ cung c·∫•p cho nh√¢n vi√™n y t·∫ø khi h·ªç ƒë·∫øn.\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "304 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 13, Qu·∫≠n 5, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0123456789"
        },
        {
          "role": "bot",
          "message": "‚ùå S·ªë ƒëi·ªán tho·∫°i ch∆∞a ƒë√∫ng ƒë·ªãnh d·∫°ng. Vui l√≤ng cung c·∫•p l·∫°i s·ªë ƒëi·ªán tho·∫°i h·ª£p l·ªá (10 ch·ªØ s·ªë b·∫Øt ƒë·∫ßu b·∫±ng 09, 03, 07, 08, 05 ho·∫∑c ƒë·ªãnh d·∫°ng +84). V√≠ d·ª•: 0912345678 ho·∫∑c +84912345678."
        },
        {
          "role": "user",
          "message": "0524774481"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã th∆∞∆°ng? C√≥ ai nguy k·ªãch kh√¥ng?"
        },
        {
          "role": "user",
          "message": "2 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 304 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 13, Qu·∫≠n 5, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0524774481\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 2 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202820-97QG ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 304 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 13, Qu·∫≠n 5, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0524774481\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 2\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_EDGE_004",
      "name": "Change Emergency Type",
      "category": "edge_case_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ ch√°y!",
          "bot_response": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. L·∫Øc x√≥c b√¨nh b·ªôt tr∆∞·ªõc khi s·ª≠ d·ª•ng\n2. Di chuy·ªÉn b√¨nh ƒë·∫øn ƒë√°m ch√°y\n3. R√∫t ch·ªët b√¨nh ch·ªØa ch√°y\n4. B√≥p van ƒë·ªÉ phun ch·∫•t ch·ªØa ch√°y v√†o ngu·ªìn l·ª≠a\n5. ƒê·ªÅ ph√≤ng nguy c∆° b·ªèng l·∫°nh khi s·ª≠ d·ª•ng b√¨nh kh√≠, tr√°nh g√¢y ho·∫°i t·ª≠ cho da\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?",
          "expected_actions": [
            "detect_emergency_type"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": "location",
          "extractions": {
            "emergencyTypes": [
              "FIRE_RESCUE"
            ]
          },
          "validation_passed": [
            "Should detect fire"
          ],
          "validation_failed": [],
          "duration_ms": 4409.806966781616,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "267 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Qu·∫≠n G√≤ V·∫•p, TP.HCM",
          "bot_response": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá.",
          "expected_actions": [
            "extract_location"
          ],
          "expected_next_step": "phone",
          "actual_next_step": "phone",
          "extractions": {
            "location": {
              "full": "267 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Qu·∫≠n G√≤ V·∫•p, TP.HCM",
              "address": "267 C√°ch M·∫°ng Th√°ng 8",
              "ward": "Ph∆∞·ªùng 4",
              "district": "Qu·∫≠n G√≤ V·∫•p",
              "city": "Th√†nh ph·ªë H·ªì Ch√≠ Minh"
            }
          },
          "validation_passed": [
            "Should extract location"
          ],
          "validation_failed": [],
          "duration_ms": 1639.8122310638428,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "0902274826",
          "bot_response": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?",
          "expected_actions": [
            "validate_phone"
          ],
          "expected_next_step": "people",
          "actual_next_step": "people",
          "extractions": {
            "phone": "0902274826"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 1118.7827587127686,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "2 ng∆∞·ªùi",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 267 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Qu·∫≠n G√≤ V·∫•p, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0902274826\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 2 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "extract_people_count"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "affectedPeople": {
              "total": 2
            }
          },
          "validation_passed": [
            "Should show confirmation"
          ],
          "validation_failed": [],
          "duration_ms": 1034.4302654266357,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "Xin l·ªói, kh√¥ng ph·∫£i ch√°y. Th·ª±c ra l√† c√≥ ng∆∞·ªùi b·ªã th∆∞∆°ng do tai n·∫°n",
          "bot_response": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 267 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Qu·∫≠n G√≤ V·∫•p, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô, C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0902274826\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 2 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)",
          "expected_actions": [
            "detect_correction",
            "update_emergency_type"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": "phone",
          "extractions": {
            "emergencyTypes": [
              "MEDICAL"
            ],
            "isCorrection": true
          },
          "validation_passed": [
            "Should update to MEDICAL",
            "Should update guidance"
          ],
          "validation_failed": [],
          "duration_ms": 1625.9238719940186,
          "errors": []
        },
        {
          "turn_number": 6,
          "user_message": "ƒê√∫ng",
          "bot_response": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202902-YS1U ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 267 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Qu·∫≠n G√≤ V·∫•p, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô, C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0902274826\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 2\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£.",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": "phone",
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [
            "Should create ticket with MEDICAL type"
          ],
          "validation_failed": [],
          "duration_ms": 7817.125558853149,
          "errors": []
        }
      ],
      "total_turns": 6,
      "completed_turns": 6,
      "workflow_completed": true,
      "ticket_created": true,
      "ticket_id": "TD-20260103-202902-YS1U",
      "metrics": {
        "workflow_completion": 0.43559450935300453,
        "conversation_coherence": 0.9009014302314817,
        "state_transition": 0.9754914992381604,
        "information_extraction": 0.5310558407178083,
        "correction_handling": 0.8849198257893894,
        "first_aid_guidance": 0.43601536718618555
      },
      "overall_passed": false,
      "total_duration_ms": 41393.515,
      "timestamp": "2026-01-04T03:28:46.830765",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ ch√°y!"
        },
        {
          "role": "bot",
          "message": "üí° **H∆Ø·ªöNG D·∫™N X·ª¨ L√ù BAN ƒê·∫¶U:**\n1. L·∫Øc x√≥c b√¨nh b·ªôt tr∆∞·ªõc khi s·ª≠ d·ª•ng\n2. Di chuy·ªÉn b√¨nh ƒë·∫øn ƒë√°m ch√°y\n3. R√∫t ch·ªët b√¨nh ch·ªØa ch√°y\n4. B√≥p van ƒë·ªÉ phun ch·∫•t ch·ªØa ch√°y v√†o ngu·ªìn l·ª≠a\n5. ƒê·ªÅ ph√≤ng nguy c∆° b·ªèng l·∫°nh khi s·ª≠ d·ª•ng b√¨nh kh√≠, tr√°nh g√¢y ho·∫°i t·ª≠ cho da\n\n---\n\nB·∫°n cho t√¥i ƒë·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë)?"
        },
        {
          "role": "user",
          "message": "267 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Qu·∫≠n G√≤ V·∫•p, TP.HCM"
        },
        {
          "role": "bot",
          "message": "Cho t√¥i s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ l·ª±c l∆∞·ª£ng c·ª©u h·ªô li√™n h·ªá."
        },
        {
          "role": "user",
          "message": "0902274826"
        },
        {
          "role": "bot",
          "message": "C√≥ bao nhi√™u ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng? C√≥ ai b·ªã m·∫Øc k·∫πt kh√¥ng?"
        },
        {
          "role": "user",
          "message": "2 ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 267 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Qu·∫≠n G√≤ V·∫•p, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0902274826\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 2 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·ª©u h·ªèa\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "Xin l·ªói, kh√¥ng ph·∫£i ch√°y. Th·ª±c ra l√† c√≥ ng∆∞·ªùi b·ªã th∆∞∆°ng do tai n·∫°n"
        },
        {
          "role": "bot",
          "message": "üìã **X√ÅC NH·∫¨N TH√îNG TIN PHI·∫æU KH·∫®N C·∫§P:**\n\n‚Ä¢ **ƒê·ªãa ƒëi·ªÉm:** 267 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Qu·∫≠n G√≤ V·∫•p, TP.HCM\n‚Ä¢ **Lo·∫°i t√¨nh hu·ªëng:** PCCC & C·ª©u n·∫°n c·ª©u h·ªô, C·∫•p c·ª©u y t·∫ø\n‚Ä¢ **S·ªë ƒëi·ªán tho·∫°i:** 0902274826\n‚Ä¢ **S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng:** 2 ng∆∞·ªùi\n\nüö® **L·ª±c l∆∞·ª£ng s·∫Ω ƒëi·ªÅu ƒë·ªông:** C·∫•p c·ª©u\n\n‚ö†Ô∏è **Vui l√≤ng x√°c nh·∫≠n th√¥ng tin tr√™n ƒë√£ ch√≠nh x√°c?** (Tr·∫£ l·ªùi \"ƒê√∫ng\" ho·∫∑c \"X√°c nh·∫≠n\" ƒë·ªÉ t·∫°o phi·∫øu kh·∫©n c·∫•p)"
        },
        {
          "role": "user",
          "message": "ƒê√∫ng"
        },
        {
          "role": "bot",
          "message": "‚úÖ **PHI·∫æU KH·∫®N C·∫§P TD-20260103-202902-YS1U ƒê√É ƒê∆Ø·ª¢C T·∫†O**\n\nüìã **Th√¥ng tin ƒë√£ ghi nh·∫≠n:**\n‚Ä¢ ƒê·ªãa ƒëi·ªÉm: 267 C√°ch M·∫°ng Th√°ng 8, Ph∆∞·ªùng 4, Qu·∫≠n G√≤ V·∫•p, TP.HCM\n‚Ä¢ Lo·∫°i t√¨nh hu·ªëng: PCCC & C·ª©u n·∫°n c·ª©u h·ªô, C·∫•p c·ª©u y t·∫ø\n‚Ä¢ S·ªë ƒëi·ªán tho·∫°i: 0902274826\n‚Ä¢ S·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng: 2\n\nüö® **C·∫•p c·ª©u ƒëang ƒë∆∞·ª£c ƒëi·ªÅu ƒë·ªông ƒë·∫øn ngay!**\n\nVui l√≤ng gi·ªØ b√¨nh tƒ©nh v√† th·ª±c hi·ªán theo h∆∞·ªõng d·∫´n ƒë√£ cung c·∫•p trong khi ch·ªù l·ª±c l∆∞·ª£ng ch·ª©c nƒÉng ƒë·∫øn h·ªó tr·ª£."
        }
      ]
    },
    {
      "test_case_id": "MULTI_EDGE_005",
      "name": "Long Conversation with Clarifications",
      "category": "edge_case_flow",
      "turns": [
        {
          "turn_number": 1,
          "user_message": "C√≥ v·∫•n ƒë·ªÅ ·ªü ƒë√¢y",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "ask_clarification"
          ],
          "expected_next_step": "emergency_clarification",
          "actual_next_step": null,
          "extractions": {},
          "validation_passed": [
            "Should ask what happened"
          ],
          "validation_failed": [],
          "duration_ms": 4.3926239013671875,
          "errors": []
        },
        {
          "turn_number": 2,
          "user_message": "C√≥ ng∆∞·ªùi b·ªã th∆∞∆°ng",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "detect_emergency_type"
          ],
          "expected_next_step": "first_aid_then_location",
          "actual_next_step": null,
          "extractions": {
            "emergencyTypes": [
              "MEDICAL"
            ]
          },
          "validation_passed": [],
          "validation_failed": [
            "Should detect medical"
          ],
          "duration_ms": 3.5271644592285156,
          "errors": []
        },
        {
          "turn_number": 3,
          "user_message": "G·∫ßn ƒë√¢y",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "ask_specific_location"
          ],
          "expected_next_step": "location_clarification",
          "actual_next_step": null,
          "extractions": {},
          "validation_passed": [],
          "validation_failed": [
            "Should ask for specific address"
          ],
          "duration_ms": 4.218339920043945,
          "errors": []
        },
        {
          "turn_number": 4,
          "user_message": "·ªû ƒë∆∞·ªùng Nguy·ªÖn Hu·ªá",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "extract_partial",
            "ask_more"
          ],
          "expected_next_step": "location_clarification",
          "actual_next_step": null,
          "extractions": {
            "location": {
              "address": "ƒê∆∞·ªùng Nguy·ªÖn Hu·ªá"
            }
          },
          "validation_passed": [],
          "validation_failed": [
            "Should ask for ward/district"
          ],
          "duration_ms": 17.134666442871094,
          "errors": []
        },
        {
          "turn_number": 5,
          "user_message": "Qu·∫≠n 1",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "extract_partial",
            "ask_more"
          ],
          "expected_next_step": "location_clarification",
          "actual_next_step": null,
          "extractions": {
            "location": {
              "district": "Qu·∫≠n 1"
            }
          },
          "validation_passed": [],
          "validation_failed": [
            "Should ask for specific number"
          ],
          "duration_ms": 3.5669803619384766,
          "errors": []
        },
        {
          "turn_number": 6,
          "user_message": "S·ªë 123, Ph∆∞·ªùng B·∫øn Ngh√©",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "complete_location",
            "ask_phone"
          ],
          "expected_next_step": "phone",
          "actual_next_step": null,
          "extractions": {
            "location": {
              "address": "S·ªë 123",
              "ward": "Ph∆∞·ªùng B·∫øn Ngh√©"
            }
          },
          "validation_passed": [
            "Should have complete location"
          ],
          "validation_failed": [],
          "duration_ms": 2.9621124267578125,
          "errors": []
        },
        {
          "turn_number": 7,
          "user_message": "0912345678",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "validate_phone"
          ],
          "expected_next_step": "people",
          "actual_next_step": null,
          "extractions": {
            "phone": "0912345678"
          },
          "validation_passed": [
            "Should validate phone"
          ],
          "validation_failed": [],
          "duration_ms": 16.677379608154297,
          "errors": []
        },
        {
          "turn_number": 8,
          "user_message": "Kh√¥ng bi·∫øt, nhi·ªÅu ng∆∞·ªùi",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "estimate_people"
          ],
          "expected_next_step": "confirmation",
          "actual_next_step": null,
          "extractions": {
            "affectedPeople": {
              "total": 5
            }
          },
          "validation_passed": [
            "Should estimate people count"
          ],
          "validation_failed": [],
          "duration_ms": 17.496347427368164,
          "errors": []
        },
        {
          "turn_number": 9,
          "user_message": "X√°c nh·∫≠n",
          "bot_response": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message",
          "expected_actions": [
            "create_ticket"
          ],
          "expected_next_step": "complete",
          "actual_next_step": null,
          "extractions": {
            "userConfirmed": true
          },
          "validation_passed": [],
          "validation_failed": [
            "Should create ticket"
          ],
          "duration_ms": 17.397642135620117,
          "errors": []
        }
      ],
      "total_turns": 9,
      "completed_turns": 9,
      "workflow_completed": false,
      "ticket_created": false,
      "ticket_id": null,
      "metrics": {
        "workflow_completion": 0.014804719803168947,
        "conversation_coherence": 0.1280481226922085,
        "state_transition": 0.0010986941841235934,
        "information_extraction": 0.07587210293457049,
        "correction_handling": 0.01192029110704336,
        "first_aid_guidance": 0.008509904036636975
      },
      "overall_passed": false,
      "total_duration_ms": 19264.296000000002,
      "timestamp": "2026-01-04T03:29:28.224524",
      "errors": [],
      "conversation_log": [
        {
          "role": "user",
          "message": "C√≥ v·∫•n ƒë·ªÅ ·ªü ƒë√¢y"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "C√≥ ng∆∞·ªùi b·ªã th∆∞∆°ng"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "G·∫ßn ƒë√¢y"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "·ªû ƒë∆∞·ªùng Nguy·ªÖn Hu·ªá"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "Qu·∫≠n 1"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "S·ªë 123, Ph∆∞·ªùng B·∫øn Ngh√©"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "0912345678"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "Kh√¥ng bi·∫øt, nhi·ªÅu ng∆∞·ªùi"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        },
        {
          "role": "user",
          "message": "X√°c nh·∫≠n"
        },
        {
          "role": "bot",
          "message": "Error: 429 Client Error: Too Many Requests for url: http://localhost:5000/api/chat/message"
        }
      ]
    }
  ]
}